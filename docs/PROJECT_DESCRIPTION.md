# Полное описание проекта Timer Widget

**Проект:** Timer Widget v1.2.4  
**Тип:** кроссплатформенное desktop-приложение на Electron  
**Платформы:** Windows, macOS  
**Стек:** Electron 33.2.0, HTML/CSS, Vanilla JavaScript, Node.js  

---

## 1. Назначение проекта

Timer Widget — это легковесный, визуально современный таймер для рабочего стола с несколькими режимами отображения, прозрачными виджетами и расширенной кастомизацией внешнего вида и звуковых уведомлений. Приложение предназначено для выступлений, презентаций, работы по тайм‑боксам и повседневного контроля времени.

---

## 2. Ключевые возможности

### 2.1. Управление таймером
- Установка времени в **часах / минутах / секундах**.
- Запуск, пауза, продолжение, сброс.
- Быстрые пресеты (5m, 10m, 15m, 30m, 45m, 60m).
- Режим переработки (overrun) с лимитом — поддержка отрицательного времени.
- Цветовые статусы: **норма → предупреждение → критично → переработка**.

### 2.2. Режимы отображения
- **Полноэкранный режим** (для сцен/презентаций).
- **Мини‑виджет таймера** (always‑on‑top, прозрачный).
- **Виджет часов** (аналоговый/цифровой, дата, часовой пояс).
- **Панель управления** с вкладками для настройки всех параметров.

### 2.3. Стили отображения таймера (полноэкранный режим)
- **Circle** — круговой прогресс‑бар.
- **Digital** — крупные цифровые часы.
- **Flip** — анимированные flip‑карточки.
- **Analog** — стрелочные часы.

### 2.4. Информационные блоки
В полноэкранном режиме поддерживаются 3 независимых блока:
- Текущее время.
- Время события.
- Время окончания.
Каждый блок может отображать мини‑аналоговые часы и цифровое значение.

### 2.5. Звуковые уведомления
- 12 встроенных звуков (bell, gong, chime, alert и др.).
- Загрузка своих звуков (MP3, WAV, OGG до 5 MB).
- Звук окончания таймера.
- Звук каждую минуту.

### 2.6. Визуальная кастомизация
- Готовые темы (Default, Ocean, Sunset, Forest, Lavender, Midnight).
- Настройка ключевых цветов: primary, secondary, warning, danger, overtime.
- Фон: сплошной цвет, градиент, изображение по URL или локальный файл.
- Параметры фона: размер, позиция, повтор, затемнение.

---

## 3. Архитектура и окна приложения

### 3.1. Архитектурная схема
- **Main Process (electron-main.js)** — управление состоянием таймера, окнами и синхронизацией.
- **Renderer Processes** — независимые UI‑окна (HTML/JS/CSS) с IPC‑обменом.

### 3.2. Окна приложения
- **Control Window** — основная панель управления.
- **Widget Window** — прозрачный мини‑таймер.
- **Display Window** — полноэкранный таймер.
- **Clock Widget Window** — виджет часов.

### 3.3. IPC‑синхронизация
- Централизованное управление из main process.
- События для запуска/паузы/сброса таймера.
- Обновления настроек цветов, дисплея и виджетов.
- Трансляция состояния таймера во все окна каждую секунду.

---

## 4. Хранение настроек

Локальные настройки сохраняются через `localStorage`:
- Цветовые схемы и темы.
- Настройки дисплея и отображения.
- Звуковые параметры и пользовательские звуки.
- Положение, размер и прозрачность виджетов.
- Настройки часов (формат, секунды, дата, часовой пояс).

---

## 5. Основные компоненты проекта

Ключевые файлы:
- `electron-main.js` — основной процесс и управление окнами.
- `electron-control.html` — панель управления.
- `electron-widget.html` — мини‑виджет таймера.
- `electron-clock-widget.html` — виджет часов.
- `display.html` + `display-script.js` — полноэкранный режим.
- `styles.css` — общие стили.
- `preload.js` — безопасный мост между main и renderer.
- `security.js` — утилиты безопасности.

---

## 6. Сборка и запуск

### 6.1. Требования
- Node.js >= 16.x
- npm >= 8.x

### 6.2. Основные команды
```bash
npm install
npm start
npm run build
npm run build:win
npm run build:mac
```

---

## 7. Безопасность

- Включена изоляция контекста (`contextIsolation: true`).
- Отключена интеграция Node.js в renderer (`nodeIntegration: false`).
- Используется `preload.js` и IPC‑allowlist.
- CSP включен во всех HTML окнах.

---

## 8. Ограничения

- CSP допускает `unsafe-inline` из‑за inline‑скриптов в HTML.
- LocalStorage ограничен по объему (актуально для больших звуков и фонов).
- Flip‑анимации могут быть тяжелыми на слабых системах.
- Официальная поддержка только Windows и macOS.

---

## 9. Итог

Timer Widget — это готовое к использованию Electron‑приложение с продуманной архитектурой и расширенной кастомизацией. Оно объединяет удобство управления, несколько режимов отображения, звуковые уведомления и визуально выразительный интерфейс, подходящий как для рабочих задач, так и для публичных выступлений.
