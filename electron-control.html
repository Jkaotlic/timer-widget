<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¢–∞–π–º–µ—Ä–æ–º</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* –ù–æ–≤—ã–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UI */
        * {
            box-sizing: border-box;
        }
        html, body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        .control-window {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            padding: 12px;
            padding-bottom: 40px;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .control-panel {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 0;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4);
            max-width: 100%;
            width: 100%;
            margin: 0 auto;
            overflow: visible;
        }

        /* –í–µ—Ä—Ö–Ω—è—è —Å–µ–∫—Ü–∏—è —Å —Ç–∞–π–º–µ—Ä–æ–º */
        .timer-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px 16px;
            text-align: center;
            position: relative;
        }

        .timer-header h1 {
            color: white;
            font-size: 1em;
            font-weight: 500;
            margin: 0 0 10px 0;
            opacity: 0.9;
            letter-spacing: 1px;
        }

        .timer-display-main {
            font-size: 3.5em;
            font-weight: 700;
            color: white;
            font-family: 'Courier New', monospace;
            text-shadow: 0 4px 20px rgba(0,0,0,0.3);
            letter-spacing: 2px;
            margin-bottom: 12px;
            transition: color 0.3s;
        }

        .timer-display-main.danger {
            color: #ff4444;
            text-shadow: 0 4px 20px rgba(255, 68, 68, 0.5);
        }

        .timer-display-main.warning {
            color: #ffc107;
            text-shadow: 0 4px 20px rgba(255, 193, 7, 0.5);
        }

        .timer-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            color: white;
            font-size: 0.8em;
            font-weight: 500;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #ccc;
        }

        .status-dot.running {
            background: #38ef7d;
            box-shadow: 0 0 8px #38ef7d;
            animation: pulse-dot 1.5s infinite;
        }

        .status-dot.paused {
            background: #ffd700;
        }

        .status-dot.finished {
            background: #ff4757;
            animation: pulse-dot 0.5s infinite;
        }

        @keyframes pulse-dot {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.2); }
        }

        /* –ì–ª–∞–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .main-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 14px 16px;
            background: #f8f9ff;
            border-bottom: 1px solid rgba(102, 126, 234, 0.1);
        }

        .main-btn {
            width: 52px;
            height: 52px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .main-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .main-btn:active:not(:disabled) {
            transform: translateY(-1px);
        }

        .main-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .main-btn.start {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }

        .main-btn.pause {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .main-btn.reset {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        /* –°–µ–∫—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
        .content-section {
            padding: 12px 16px;
        }

        /* –¢–∞–±—ã */
        .tabs {
            display: flex;
            background: #f0f2ff;
            border-radius: 10px;
            padding: 3px;
            margin-bottom: 14px;
        }

        .tab-btn {
            flex: 1;
            padding: 8px 2px;
            border: none;
            background: transparent;
            color: #666;
            font-size: 0.7em;
            font-weight: 600;
            cursor: pointer;
            border-radius: 7px;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
            min-width: 0;
        }

        .tab-btn span.icon {
            font-size: 1.1em;
        }

        .tab-btn:hover {
            color: #667eea;
        }

        .tab-btn.active {
            background: white;
            color: #667eea;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
            overflow: visible;
            padding-right: 4px;
        }

        /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ –¥–ª—è –≤–∫–ª–∞–¥–æ–∫ */
        .tab-content::-webkit-scrollbar {
            width: 6px;
        }

        .tab-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .tab-content::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }

        .tab-content::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* –ö–Ω–æ–ø–∫–∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è */
        .pos-btn {
            width: 32px;
            height: 32px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.05);
            color: inherit;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pos-btn:hover {
            background: rgba(102, 126, 234, 0.3);
            border-color: #667eea;
        }

        .pos-btn.active {
            background: #667eea;
            border-color: #667eea;
            color: white;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –ü—Ä–µ—Å–µ—Ç—ã –≤—Ä–µ–º–µ–Ω–∏ */
        .time-presets {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 12px;
        }

        .preset-btn {
            padding: 12px 6px;
            font-size: 0.9em;
            border: 2px solid #e8ecff;
            border-radius: 10px;
            background: white;
            color: #333;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        .preset-btn:hover {
            border-color: #667eea;
            background: #f8f9ff;
            transform: translateY(-2px);
        }

        .preset-btn:active {
            transform: translateY(0);
        }

        /* –í–≤–æ–¥ –≤—Ä–µ–º–µ–Ω–∏ */
        .time-input-group {
            display: flex;
            gap: 6px;
            align-items: center;
            background: #f8f9ff;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 12px;
        }

        .time-input {
            flex: 1;
            padding: 10px;
            font-size: 1.1em;
            text-align: center;
            border: 2px solid #e8ecff;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-weight: 600;
            transition: border-color 0.2s;
        }

        .time-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .time-separator {
            font-size: 1.3em;
            font-weight: 700;
            color: #667eea;
        }

        .set-time-btn {
            padding: 10px 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .set-time-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        /* –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ */
        .adjust-section {
            background: #f8f9ff;
            padding: 12px;
            border-radius: 10px;
        }

        .adjust-title {
            font-size: 0.75em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .adjust-btns {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .adjust-btn {
            flex: 1;
            min-width: 70px;
            padding: 10px 8px;
            font-size: 0.9em;
            border: none;
            border-radius: 8px;
            background: white;
            color: #333;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .adjust-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        .adjust-btn.minus {
            color: #f5576c;
        }

        .adjust-btn.minus:hover {
            background: #f5576c;
            color: white;
        }

        /* –ö–Ω–æ–ø–∫–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è –æ–∫–æ–Ω */
        .window-btns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .window-btn {
            padding: 12px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.85em;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }

        .window-btn .icon {
            font-size: 1.5em;
        }

        .window-btn.widget {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .window-btn.display {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }

        .window-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ - —Å–µ–∫—Ü–∏–∏ */
        .settings-group {
            background: #f8f9ff;
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 12px;
        }

        .settings-group-title {
            font-size: 0.8em;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .settings-group-title .icon {
            font-size: 1em;
        }

        /* –¶–≤–µ—Ç–∞ */
        .color-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .color-item {
            text-align: center;
        }

        .color-item label {
            display: block;
            font-size: 0.7em;
            color: #666;
            margin-bottom: 4px;
        }

        .color-picker {
            width: 100%;
            height: 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            padding: 0;
        }

        /* –¢–µ–º—ã */
        .themes-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 3px;
        }

        .theme-btn {
            width: 20px;
            height: 20px;
            border: 1px solid transparent;
            border-radius: 4px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.2s;
        }

        .theme-btn:hover {
            transform: scale(1.15);
            border-color: rgba(0,0,0,0.3);
        }

        .theme-btn.active {
            border-color: #333;
            box-shadow: 0 0 0 1px #333;
        }

        .theme-btn::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, var(--t1) 0%, var(--t2) 100%);
        }

        /* –ó–≤—É–∫–∏ */
        .sound-row {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .sound-row:last-child {
            border-bottom: none;
        }

        .sound-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 110px;
        }

        .sound-toggle input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #667eea;
        }

        .sound-select {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 0.85em;
            min-width: 0;
        }

        .sound-preview {
            width: 36px;
            height: 36px;
            border: none;
            border-radius: 8px;
            background: #667eea;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .sound-preview:hover {
            background: #5568d3;
            transform: scale(1.1);
        }

        /* –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∑–≤—É–∫–∏ */
        .custom-sounds-section {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 2px dashed rgba(102, 126, 234, 0.2);
        }

        .custom-sound-list {
            max-height: 120px;
            overflow-y: auto;
            margin-bottom: 10px;
        }

        .custom-sound-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 10px;
            background: #f0f2ff;
            border-radius: 8px;
            margin-bottom: 6px;
            font-size: 0.85em;
        }

        .custom-sound-item .name {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            color: #333;
        }

        .custom-sound-item .btn {
            width: 28px;
            height: 28px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .custom-sound-item .play-btn {
            background: #667eea;
            color: white;
        }

        .custom-sound-item .delete-btn {
            background: rgba(245, 87, 108, 0.15);
            color: #f5576c;
        }

        .custom-sound-item .btn:hover {
            transform: scale(1.1);
        }

        .add-sound-row {
            display: flex;
            gap: 8px;
        }

        .add-sound-btn {
            flex: 1;
            padding: 10px 16px;
            border: 2px dashed #ccc;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 500;
            color: #666;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .add-sound-btn:hover {
            border-color: #667eea;
            color: #667eea;
            background: #f8f9ff;
        }

        .hidden-file-input {
            display: none;
        }

        /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ */
        .toggle-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .toggle-row:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .toggle-label {
            font-size: 0.8em;
            color: #333;
        }

        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            inset: 0;
            background-color: #ccc;
            transition: .3s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .toggle-switch input:checked + .toggle-slider {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(20px);
        }

        /* –§–æ–Ω */
        .bg-mode-tabs {
            display: flex;
            gap: 6px;
            margin-bottom: 10px;
        }

        .bg-mode-btn {
            flex: 1;
            padding: 8px 4px;
            border: 2px solid #e8ecff;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.75em;
            font-weight: 600;
            color: #666;
            transition: all 0.2s;
        }

        .bg-mode-btn.active {
            border-color: #667eea;
            background: #f0f2ff;
            color: #667eea;
        }

        .bg-controls {
            display: none;
        }

        .bg-controls.active {
            display: block;
        }

        .gradient-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .url-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e8ecff;
            border-radius: 8px;
            font-size: 0.9em;
        }

        .url-input:focus {
            outline: none;
            border-color: #667eea;
        }

        /* –ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–æ–Ω–∞ */
        .local-bg-section {
            margin-top: 12px;
        }

        .local-bg-preview {
            position: relative;
            width: 100%;
            height: 120px;
            border-radius: 12px;
            background: #f0f2ff;
            border: 2px dashed #ccc;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .local-bg-preview:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .local-bg-preview.has-image {
            border-style: solid;
            border-color: #667eea;
        }

        .local-bg-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .local-bg-placeholder {
            text-align: center;
            color: #999;
        }

        .local-bg-placeholder .icon {
            font-size: 2em;
            display: block;
            margin-bottom: 8px;
        }

        .local-bg-placeholder .text {
            font-size: 0.85em;
            font-weight: 500;
        }

        .local-bg-actions {
            position: absolute;
            top: 8px;
            right: 8px;
            display: flex;
            gap: 6px;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .local-bg-preview:hover .local-bg-actions {
            opacity: 1;
        }

        .local-bg-action-btn {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .local-bg-action-btn.change {
            background: rgba(102, 126, 234, 0.9);
            color: white;
        }

        .local-bg-action-btn.delete {
            background: rgba(245, 87, 108, 0.9);
            color: white;
        }

        .local-bg-action-btn:hover {
            transform: scale(1.1);
        }

        .bg-fit-options {
            display: flex;
            gap: 6px;
            margin-top: 10px;
        }

        .bg-fit-btn {
            flex: 1;
            padding: 8px;
            border: 2px solid #e8ecff;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.75em;
            font-weight: 600;
            color: #666;
            transition: all 0.2s;
        }

        .bg-fit-btn.active {
            border-color: #667eea;
            background: #f0f2ff;
            color: #667eea;
        }

        .bg-overlay-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .bg-overlay-row label {
            font-size: 0.8em;
            color: #666;
            white-space: nowrap;
        }

        .bg-overlay-row input[type="range"] {
            flex: 1;
            height: 6px;
            background: #e8ecff;
            border-radius: 3px;
            outline: none;
            appearance: none;
            -webkit-appearance: none;
        }

        .bg-overlay-row input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .bg-overlay-value {
            font-size: 0.8em;
            color: #667eea;
            font-weight: 600;
            min-width: 35px;
            text-align: right;
        }

        /* –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ */
        .reset-btn {
            width: 100%;
            padding: 12px;
            border: 2px solid #e8ecff;
            background: white;
            border-radius: 10px;
            color: #666;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 8px;
        }

        .reset-btn:hover {
            border-color: #f5576c;
            color: #f5576c;
        }

        /* –°–∫—Ä–æ–ª–ª –≤ –æ–∫–Ω–µ */
        .control-window {
            overflow-y: auto;
        }

        .control-window::-webkit-scrollbar {
            width: 8px;
        }

        .control-window::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
        }

        .control-window::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 500px) {
            .timer-display-main {
                font-size: 3.5em;
            }
            
            .time-presets {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .themes-grid {
                grid-template-columns: repeat(6, 1fr);
            }
        }

        /* –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ä–µ–∂–∏–º */
        .compact-section {
            padding: 12px 16px;
            border-bottom: 1px solid rgba(102, 126, 234, 0.1);
        }

        .quick-presets {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .quick-preset {
            padding: 8px 14px;
            border: 2px solid #e8ecff;
            border-radius: 8px;
            background: white;
            color: #333;
            font-weight: 600;
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quick-preset:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .quick-preset.active {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .quick-windows {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        .quick-window-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            font-size: 0.85em;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .quick-window-btn.widget {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .quick-window-btn.clock {
            background: linear-gradient(135deg, #38ef7d 0%, #11998e 100%);
            color: white;
        }

        .quick-window-btn.display {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }

        .quick-window-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        /* –ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ */
        .settings-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px;
            background: #f8f9ff;
            border: none;
            cursor: pointer;
            width: 100%;
            font-size: 0.85em;
            color: #666;
            transition: all 0.2s;
        }

        .settings-toggle:hover {
            background: #f0f2ff;
            color: #667eea;
        }

        .settings-toggle .arrow {
            transition: transform 0.3s;
        }

        .settings-toggle.open .arrow {
            transform: rotate(180deg);
        }

        /* –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ */
        .advanced-settings {
            display: none;
            overflow: visible;
        }

        .advanced-settings.open {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .advanced-settings .content-section {
            padding: 0 16px 20px;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 0 0 20px 20px;
        }

        /* FAQ –∫–Ω–æ–ø–∫–∞ */
        .faq-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.15);
            color: white;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            backdrop-filter: blur(5px);
            z-index: 100;
            -webkit-app-region: no-drag;
        }

        .faq-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: white;
            transform: scale(1.1);
        }

        /* FAQ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .faq-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .faq-modal.show {
            opacity: 1;
            pointer-events: auto;
        }

        .faq-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 20px;
            width: 95%;
            max-width: 500px;
            max-height: 85vh;
            overflow: hidden;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.5);
            transform: translateY(20px) scale(0.95);
            transition: transform 0.3s;
            display: flex;
            flex-direction: column;
        }

        .faq-modal.show .faq-content {
            transform: translateY(0) scale(1);
        }

        .faq-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .faq-header h2 {
            margin: 0;
            color: white;
            font-size: 1.1em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .faq-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .faq-close:hover {
            background: rgba(255, 68, 68, 0.6);
            transform: scale(1.1);
        }

        .faq-body {
            padding: 16px 20px;
            overflow-y: auto;
            flex: 1;
        }

        .faq-section {
            margin-bottom: 16px;
        }

        .faq-section-title {
            color: #667eea;
            font-size: 0.85em;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .faq-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            margin-bottom: 8px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .faq-question {
            padding: 12px 14px;
            color: white;
            font-size: 0.85em;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.2s;
        }

        .faq-question:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .faq-question .arrow {
            font-size: 0.8em;
            transition: transform 0.3s;
            opacity: 0.6;
        }

        .faq-item.open .faq-question .arrow {
            transform: rotate(180deg);
        }

        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            padding: 0 14px;
            color: rgba(255, 255, 255, 0.85);
            font-size: 0.8em;
            line-height: 1.6;
        }

        .faq-item.open .faq-answer {
            max-height: 500px;
            padding: 0 14px 14px;
        }

        .faq-answer ul {
            margin: 8px 0;
            padding-left: 20px;
            color: rgba(255, 255, 255, 0.85);
        }

        .faq-answer ul li {
            margin-bottom: 6px;
            line-height: 1.5;
            color: rgba(255, 255, 255, 0.85);
        }

        .faq-answer p {
            margin: 8px 0;
            line-height: 1.5;
            color: rgba(255, 255, 255, 0.85);
        }

        .faq-answer strong {
            color: #fff;
        }

        .faq-answer-content {
            padding: 0 14px 14px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.8em;
            line-height: 1.6;
        }

        .faq-answer-content ul {
            margin: 8px 0;
            padding-left: 20px;
        }

        .faq-answer-content li {
            margin-bottom: 4px;
        }

        .faq-answer-content code {
            background: rgba(102, 126, 234, 0.3);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            font-size: 0.95em;
        }

        .faq-shortcut {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            background: rgba(255, 255, 255, 0.1);
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.9em;
            margin: 2px;
        }

        .faq-shortcuts {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .shortcut {
            display: flex;
            align-items: center;
            gap: 6px;
            flex-wrap: wrap;
        }

        .key {
            background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            padding: 4px 10px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.85em;
            color: #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .shortcut-desc {
            color: rgba(255, 255, 255, 0.7);
            margin-left: 8px;
        }

        .faq-answer ul {
            margin: 8px 0;
            padding-left: 20px;
        }

        .faq-answer ul li {
            margin-bottom: 6px;
            line-height: 1.5;
        }

        .faq-answer p {
            margin: 8px 0;
            line-height: 1.5;
        }

        .faq-footer {
            padding: 12px 20px;
            background: rgba(0, 0, 0, 0.2);
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.75em;
        }

        .faq-footer a {
            color: #667eea;
            text-decoration: none;
        }

        .faq-footer a:hover {
            text-decoration: underline;
        }

        /* FIX BUG-011: –°—Ç–∏–ª–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤–≤–æ–¥–∞ */
        .input-error {
            border-color: #ff4444 !important;
            background-color: rgba(255, 68, 68, 0.1) !important;
            animation: shake 0.3s;
        }

        .error-message {
            color: #ff4444;
            font-size: 0.75rem;
            margin-top: 4px;
            display: none;
            padding: 4px 8px;
            background: rgba(255, 68, 68, 0.1);
            border-radius: 4px;
            border-left: 3px solid #ff4444;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* FIX BUG-028: Loading indicator styles */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #fff;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        .loading-text {
            color: white;
            margin-top: 15px;
            font-size: 14px;
            text-align: center;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Inline loading indicator (small) */
        .inline-loader {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(74, 175, 80, 0.3);
            border-top: 2px solid #4CAF50;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
            margin-left: 8px;
            vertical-align: middle;
        }

        .loading-button {
            opacity: 0.6;
            pointer-events: none;
            position: relative;
        }

        /* Info banners for better UX */
        .info-banner {
            background: rgba(103, 126, 234, 0.1);
            border-left: 3px solid #667eea;
            padding: 10px 12px;
            border-radius: 6px;
            margin-bottom: 12px;
            font-size: 0.85em;
            line-height: 1.5;
            color: rgba(255, 255, 255, 0.8);
        }

        .info-banner.tip {
            background: rgba(74, 175, 80, 0.1);
            border-left-color: #4CAF50;
        }

        .info-banner.warning {
            background: rgba(255, 152, 0, 0.1);
            border-left-color: #FF9800;
        }

        .info-banner strong {
            color: #fff;
        }

        .info-banner code {
            background: rgba(0, 0, 0, 0.3);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
    </style>
</head>
<body class="control-window">
    <div class="control-panel">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å —Ç–∞–π–º–µ—Ä–æ–º -->
        <div class="timer-header">
            <button class="faq-btn" id="faqBtn" title="–°–ø—Ä–∞–≤–∫–∞">?</button>
            <h1>‚è±Ô∏è –¢–ê–ô–ú–ï–†</h1>
            <div class="timer-display-main" id="controlTime">00:00</div>
            <div class="timer-status">
                <span class="status-dot" id="statusDot"></span>
                <span id="statusText">–ì–æ—Ç–æ–≤</span>
            </div>
        </div>

        <!-- –ì–ª–∞–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
        <div class="main-controls">
            <button class="main-btn start" id="startBtn" title="–°—Ç–∞—Ä—Ç">‚ñ∂</button>
            <button class="main-btn pause" id="pauseBtn" title="–ü–∞—É–∑–∞" disabled>‚è∏</button>
            <button class="main-btn reset" id="resetBtn" title="–°–±—Ä–æ—Å">‚Ü∫</button>
        </div>

        <!-- –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–µ—Å–µ—Ç—ã -->
        <div class="compact-section">
            <div class="quick-presets">
                <button class="quick-preset" data-minutes="5">5–º</button>
                <button class="quick-preset" data-minutes="10">10–º</button>
                <button class="quick-preset" data-minutes="15">15–º</button>
                <button class="quick-preset" data-minutes="30">30–º</button>
                <button class="quick-preset" data-minutes="45">45–º</button>
                <button class="quick-preset" data-minutes="60">60–º</button>
            </div>
        </div>

        <!-- –ë—ã—Å—Ç—Ä—ã–µ –æ–∫–Ω–∞ -->
        <div class="compact-section">
            <div class="quick-windows">
                <button class="quick-window-btn widget" id="openWidgetBtn">‚è±Ô∏è –í–∏–¥–∂–µ—Ç —Ç–∞–π–º–µ—Ä–∞</button>
                <button class="quick-window-btn clock" id="openClockBtn">üïê –í–∏–¥–∂–µ—Ç —á–∞—Å–æ–≤</button>
                <button class="quick-window-btn display" id="openDisplayBtn">üñ•Ô∏è –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º</button>
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
        <button class="settings-toggle" id="settingsToggle">
            <span>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            <span class="arrow">‚ñº</span>
        </button>

        <!-- –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–∫—Ä—ã—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
        <div class="advanced-settings" id="advancedSettings">
            <div class="content-section">
                <div class="tabs">
                    <button class="tab-btn active" data-tab="time">
                        <span class="icon">‚è∞</span>
                        <span>–í—Ä–µ–º—è</span>
                    </button>
                    <button class="tab-btn" data-tab="display">
                        <span class="icon">üñ•Ô∏è</span>
                        <span>–≠–∫—Ä–∞–Ω</span>
                    </button>
                    <button class="tab-btn" data-tab="clock">
                        <span class="icon">üïê</span>
                        <span>–í–∏–¥–∂–µ—Ç</span>
                    </button>
                    <button class="tab-btn" data-tab="style">
                        <span class="icon">üé®</span>
                        <span>–§–æ–Ω</span>
                    </button>
                    <button class="tab-btn" data-tab="sound">
                        <span class="icon">üîä</span>
                        <span>–ó–≤—É–∫</span>
                    </button>
                </div>

                <!-- –¢–∞–±: –í—Ä–µ–º—è -->
                <div class="tab-content active" id="tab-time">
                    <div class="info-banner tip">
                        <strong>üí° –ë—ã—Å—Ç—Ä—ã–µ –∫–ª–∞–≤–∏—à–∏:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ <code>1-5</code> –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ (1, 5, 10, 15, 30 –º–∏–Ω) –∏–ª–∏ <code>Space</code> –¥–ª—è —Å—Ç–∞—Ä—Ç/–ø–∞—É–∑—ã. –ù–∞–∂–º–∏—Ç–µ <code>F1</code> –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞.
                    </div>

                    <div class="time-input-group">
                        <input type="number" class="time-input" id="customMinutes" min="0" max="999" placeholder="00" value="">
                        <span class="time-separator">:</span>
                        <input type="number" class="time-input" id="customSeconds" min="0" max="59" placeholder="00" value="">
                        <button class="set-time-btn" id="setCustomTime">‚úì</button>
                    </div>

                    <div class="adjust-section">
                        <div class="adjust-title">–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞</div>
                        <div class="adjust-btns">
                            <button class="adjust-btn" data-seconds="30">+30—Å</button>
                            <button class="adjust-btn" data-seconds="60">+1–º</button>
                            <button class="adjust-btn" data-seconds="300">+5–º</button>
                            <button class="adjust-btn minus" data-seconds="-30">‚àí30—Å</button>
                            <button class="adjust-btn minus" data-seconds="-60">‚àí1–º</button>
                        </div>
                    </div>

                    <div class="settings-group" style="margin-top: 12px;">
                        <div class="toggle-row">
                            <span class="toggle-label">‚è±Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å –Ω–∏–∂–µ 0</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="allowNegative">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="toggle-row" id="overrunRow" style="display: none;">
                            <span class="toggle-label">–õ–∏–º–∏—Ç –ø–µ—Ä–µ—Ä–∞—Å—Ö–æ–¥–∞</span>
                            <input type="text" id="overrunLimit" placeholder="–º–º:—Å—Å" value="05:00" 
                                   style="width: 70px; padding: 6px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; background: rgba(30,30,50,0.8); color: white; font-size: 0.9em; font-family: 'Courier New', monospace;">
                        </div>
                    </div>
                </div>

                <!-- –¢–∞–±: –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º -->
                <div class="tab-content" id="tab-display">
                    <div class="info-banner">
                        <strong>‚å®Ô∏è –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏:</strong> –ù–∞–∂–º–∏—Ç–µ <code>D</code> –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞, <code>Esc</code> –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è.
                    </div>

                    <div class="settings-group">
                        <div class="settings-group-title">
                            <span class="icon">üñ•Ô∏è</span>
                            –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                        </div>

                        <div class="toggle-row">
                            <span class="toggle-label">–ú–æ–Ω–∏—Ç–æ—Ä –≤—ã–≤–æ–¥–∞</span>
                            <select id="displaySelect" style="padding: 6px 10px; border-radius: 6px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; cursor: pointer; font-size: 0.85em; max-width: 140px;">
                                <option value="auto" style="background: #1a1a2e;">üñ•Ô∏è –ê–≤—Ç–æ</option>
                            </select>
                        </div>

                        <div class="toggle-row">
                            <span class="toggle-label">–°—Ç–∏–ª—å</span>
                            <select id="timerStyle" style="padding: 6px 10px; border-radius: 6px; background: #1a1a2e; border: 1px solid rgba(255,255,255,0.3); color: white; cursor: pointer; font-size: 0.85em; min-width: 160px;">
                                <option value="circle" style="background: #1a1a2e; color: white;">‚≠ï –ö—Ä—É–≥–æ–≤–æ–π</option>
                                <option value="digital" style="background: #1a1a2e; color: white;">üî¢ –¶–∏—Ñ—Ä–æ–≤–æ–π LED</option>
                                <option value="flip" style="background: #1a1a2e; color: white;">üîÑ –ü–µ—Ä–µ–∫–∏–¥–Ω—ã–µ</option>
                                <option value="analog" style="background: #1a1a2e; color: white;">üïê –ê–Ω–∞–ª–æ–≥–æ–≤—ã–µ</option>
                            </select>
                        </div>

                        <div class="toggle-row">
                            <span class="toggle-label">–†–∞–∑–º–µ—Ä</span>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <input type="range" id="timerScale" min="50" max="300" value="100" style="width: 80px;">
                                <span id="timerScaleValue" style="min-width: 40px; font-size: 0.85em;">100%</span>
                            </div>
                        </div>
                    </div>

                    <div class="settings-group">
                        <div class="settings-group-title">
                            <span class="icon">üìã</span>
                            –ë–ª–æ–∫–∏ –≤—Ä–µ–º–µ–Ω–∏
                        </div>
                        
                        <div class="toggle-row">
                            <span class="toggle-label">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="showTimeBlocks">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div id="timeBlocksSettings" style="display: none;">
                            <div class="toggle-row">
                                <span class="toggle-label">–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ</span>
                                <select id="timeLayoutPreset" style="padding: 6px 10px; border-radius: 6px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.05); color: inherit; font-size: 0.85em; cursor: pointer;">
                                    <option value="frame">–†–∞–º–∫–∞</option>
                                    <option value="top-line">–°–≤–µ—Ä—Ö—É</option>
                                    <option value="bottom-line">–°–Ω–∏–∑—É</option>
                                    <option value="corners">–ü–æ —É–≥–ª–∞–º</option>
                                </select>
                            </div>
                            
                            <div class="toggle-row">
                                <span class="toggle-label">–ù–∞—á–∞–ª–æ</span>
                                <input type="time" id="eventTimeInput" value="10:00" 
                                       style="width: 90px; padding: 6px; text-align: center; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: inherit; font-size: 0.9em;">
                            </div>
                            
                            <div class="toggle-row">
                                <span class="toggle-label">–ö–æ–Ω–µ—Ü</span>
                                <input type="time" id="endTimeInput" value="12:00" 
                                       style="width: 90px; padding: 6px; text-align: center; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: inherit; font-size: 0.9em;">
                            </div>
                            
                            <div class="toggle-row">
                                <span class="toggle-label">–†–∞–∑–º–µ—Ä</span>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <input type="range" id="timeBlocksScale" min="50" max="400" value="100" style="width: 80px;">
                                    <span id="timeBlocksScaleValue" style="min-width: 45px;">100%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –¢–∞–±: –í–∏–¥–∂–µ—Ç —á–∞—Å–æ–≤ -->
                <div class="tab-content" id="tab-clock">
                    <div class="info-banner tip">
                        <strong>üí° –°–æ–≤–µ—Ç:</strong> –í–∏–¥–∂–µ—Ç —á–∞—Å–æ–≤ –º–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é <code>Ctrl + –∫–æ–ª–µ—Å–æ –º—ã—à–∏</code>. –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ –µ–≥–æ –≤ –ª—é–±–æ–µ –º–µ—Å—Ç–æ —ç–∫—Ä–∞–Ω–∞.
                    </div>

                    <div class="settings-group">
                        <div class="settings-group-title">
                            <span class="icon">üïê</span>
                            –°—Ç–∏–ª—å —á–∞—Å–æ–≤
                        </div>

                        <div class="toggle-row">
                            <span class="toggle-label">–ö–∞–∫ —É —Ç–∞–π–º–µ—Ä–∞</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="syncClockStyle" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="toggle-row" id="clockStyleRow" style="display: none;">
                            <span class="toggle-label">–°—Ç–∏–ª—å</span>
                            <select id="clockStyle" style="padding: 6px 10px; border-radius: 6px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; cursor: pointer; font-size: 0.85em;">
                                <option value="circle" style="background: #1a1a2e;">‚≠ï –ö—Ä—É–≥–æ–≤–æ–π</option>
                                <option value="digital" style="background: #1a1a2e;">üî¢ –¶–∏—Ñ—Ä–æ–≤–æ–π LED</option>
                                <option value="flip" style="background: #1a1a2e;">üîÑ –ü–µ—Ä–µ–∫–∏–¥–Ω—ã–µ —á–∞—Å—ã</option>
                                <option value="analog" style="background: #1a1a2e;">üïê –ê–Ω–∞–ª–æ–≥–æ–≤—ã–µ</option>
                            </select>
                        </div>

                        <div class="toggle-row" id="clockAnalogNumbersRow" style="display: none;">
                            <span class="toggle-label">–¶–∏—Ñ—Ä—ã –Ω–∞ —Ü–∏—Ñ–µ—Ä–±–ª–∞—Ç–µ</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="clockShowAnalogNumbers">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-group">
                        <div class="settings-group-title">
                            <span class="icon">‚öôÔ∏è</span>
                            –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                        </div>
                        
                        <div class="toggle-row">
                            <span class="toggle-label">–î–∞—Ç–∞</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="clockShowDate">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="toggle-row">
                            <span class="toggle-label">–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="clockShowTimezone">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="toggle-row">
                            <span class="toggle-label">–°–µ–∫—É–Ω–¥—ã</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="clockShowSeconds" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="toggle-row">
                            <span class="toggle-label">24-—á–∞—Å–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="clockFormat24h" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- –¢–∞–±: –§–æ–Ω -->
                <div class="tab-content" id="tab-style">
                    <div class="info-banner warning">
                        <strong>‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤:</strong> –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ 10 –ú–ë. –í—Å–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π.
                    </div>

                    <div class="settings-group">
                        <div class="settings-group-title">
                            <span class="icon">‚ú®</span>
                            –¶–≤–µ—Ç–æ–≤—ã–µ —Ç–µ–º—ã
                        </div>
                        <div class="themes-grid" id="themesGrid"></div>
                    </div>

                    <div class="settings-group">
                        <div class="settings-group-title">
                            <span class="icon">üñºÔ∏è</span>
                            –§–æ–Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                        </div>
                        <div class="bg-mode-tabs">
                            <button class="bg-mode-btn active" data-mode="solid">–¶–≤–µ—Ç</button>
                            <button class="bg-mode-btn" data-mode="gradient">–ì—Ä–∞–¥–∏–µ–Ω—Ç</button>
                            <button class="bg-mode-btn" data-mode="image">URL</button>
                            <button class="bg-mode-btn" data-mode="local">–§–∞–π–ª</button>
                        </div>
                        <div class="bg-controls active" id="bgSolidControls">
                            <input type="color" class="color-picker" id="bgSolidColor" value="#0f0c29" style="width: 100%;">
                        </div>
                        <div class="bg-controls" id="bgGradientControls">
                            <div class="gradient-row">
                                <input type="color" class="color-picker" id="bgGrad1" value="#0f0c29">
                                <input type="color" class="color-picker" id="bgGrad2" value="#302b63">
                            </div>
                        </div>
                        <div class="bg-controls" id="bgImageControls">
                            <input type="url" class="url-input" id="bgImageUrl" placeholder="https://example.com/image.jpg">
                        </div>
                        <div class="bg-controls" id="bgLocalControls">
                            <div class="local-bg-section">
                                <div class="local-bg-preview" id="localBgPreview">
                                    <div class="local-bg-placeholder" id="localBgPlaceholder">
                                        <span class="icon">üìÅ</span>
                                        <span class="text">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</span>
                                    </div>
                                    <img id="localBgImage" style="display: none;">
                                    <div class="local-bg-actions">
                                        <button class="local-bg-action-btn change" id="changeBgBtn" title="–ò–∑–º–µ–Ω–∏—Ç—å">üîÑ</button>
                                        <button class="local-bg-action-btn delete" id="deleteBgBtn" title="–£–¥–∞–ª–∏—Ç—å">‚úï</button>
                                    </div>
                                </div>
                                <input type="file" class="hidden-file-input" id="bgFileInput" 
                                       accept="image/jpeg,image/png,image/gif,image/webp,.jpg,.jpeg,.png,.gif,.webp">
                                
                                <div class="bg-fit-options" id="bgFitOptions" style="display: none;">
                                    <button class="bg-fit-btn active" data-fit="cover">–ó–∞–ø–æ–ª–Ω–∏—Ç—å</button>
                                    <button class="bg-fit-btn" data-fit="contain">–í–ø–∏—Å–∞—Ç—å</button>
                                    <button class="bg-fit-btn" data-fit="tile">–ü–ª–∏—Ç–∫–∞</button>
                                </div>
                                
                                <div class="bg-overlay-row" id="bgOverlayRow" style="display: none;">
                                    <label>–ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ:</label>
                                    <input type="range" id="bgOverlaySlider" min="0" max="80" value="30">
                                    <span class="bg-overlay-value" id="bgOverlayValue">30%</span>
                                </div>
                            </div>
                        </div>
                        <button class="reset-btn" id="resetStyleBtn">–°–±—Ä–æ—Å–∏—Ç—å —Å—Ç–∏–ª—å</button>
                    </div>
                </div>

                <!-- –¢–∞–±: –ó–≤—É–∫ -->
                <div class="tab-content" id="tab-sound">
                    <div class="info-banner warning">
                        <strong>‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤:</strong> –ê—É–¥–∏–æ—Ñ–∞–π–ª—ã –¥–æ 5 –ú–ë. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: MP3, WAV, OGG.
                    </div>

                    <div class="settings-group">
                        <div class="toggle-row">
                            <span class="toggle-label" style="font-weight: 600;">üîä –ó–≤—É–∫–∏ –≤–∫–ª—é—á–µ–Ω—ã</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="soundMasterEnabled" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-group" id="soundSettings">
                        <div class="sound-row">
                            <div class="sound-toggle">
                                <input type="checkbox" id="soundStartEnabled">
                                <label for="soundStartEnabled">–°—Ç–∞—Ä—Ç</label>
                            </div>
                            <select class="sound-select" id="soundStartPreset">
                                <option value="none">‚Äî –±–µ–∑ –∑–≤—É–∫–∞ ‚Äî</option>
                                <optgroup label="–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ">
                                    <option value="beep-short">–ö–æ—Ä–æ—Ç–∫–∏–π –±–∏–ø</option>
                                    <option value="beep-long">–î–ª–∏–Ω–Ω—ã–π –±–∏–ø</option>
                                    <option value="triple">–¢—Ä–æ–π–Ω–æ–π —Å–∏–≥–Ω–∞–ª</option>
                                    <option value="chirp">–ß–∏—Ä–ø</option>
                                    <option value="bell">–ö–æ–ª–æ–∫–æ–ª—å—á–∏–∫</option>
                                    <option value="ding">–î–∏–Ω—å</option>
                                    <option value="whoosh">–°–≤–∏—Å—Ç</option>
                                    <option value="click">–ö–ª–∏–∫</option>
                                </optgroup>
                                <optgroup label="–í–∞—à–∏ –∑–≤—É–∫–∏" id="customSoundsGroupStart"></optgroup>
                            </select>
                            <button class="sound-preview" id="soundStartPreview">‚ñ∂</button>
                        </div>

                        <div class="sound-row">
                            <div class="sound-toggle">
                                <input type="checkbox" id="soundEndEnabled" checked>
                                <label for="soundEndEnabled">–§–∏–Ω–∏—à</label>
                            </div>
                            <select class="sound-select" id="soundEndPreset">
                                <option value="none">‚Äî –±–µ–∑ –∑–≤—É–∫–∞ ‚Äî</option>
                                <optgroup label="–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ">
                                    <option value="beep-short">–ö–æ—Ä–æ—Ç–∫–∏–π –±–∏–ø</option>
                                    <option value="beep-long">–î–ª–∏–Ω–Ω—ã–π –±–∏–ø</option>
                                    <option value="triple">–¢—Ä–æ–π–Ω–æ–π —Å–∏–≥–Ω–∞–ª</option>
                                    <option value="chirp">–ß–∏—Ä–ø</option>
                                    <option value="bell">–ö–æ–ª–æ–∫–æ–ª—å—á–∏–∫</option>
                                    <option value="ding">–î–∏–Ω—å</option>
                                    <option value="alarm">–ë—É–¥–∏–ª—å–Ω–∏–∫</option>
                                    <option value="fanfare">–§–∞–Ω—Ñ–∞—Ä—ã</option>
                                    <option value="gong">–ì–æ–Ω–≥</option>
                                </optgroup>
                                <optgroup label="–í–∞—à–∏ –∑–≤—É–∫–∏" id="customSoundsGroupEnd"></optgroup>
                            </select>
                            <button class="sound-preview" id="soundEndPreview">‚ñ∂</button>
                        </div>

                        <div class="sound-row">
                            <div class="sound-toggle">
                                <input type="checkbox" id="soundMinuteEnabled">
                                <label for="soundMinuteEnabled">1 –º–∏–Ω</label>
                            </div>
                            <select class="sound-select" id="soundMinutePreset">
                                <option value="none">‚Äî –±–µ–∑ –∑–≤—É–∫–∞ ‚Äî</option>
                                <optgroup label="–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ">
                                    <option value="beep-short">–ö–æ—Ä–æ—Ç–∫–∏–π –±–∏–ø</option>
                                    <option value="beep-long">–î–ª–∏–Ω–Ω—ã–π –±–∏–ø</option>
                                    <option value="triple">–¢—Ä–æ–π–Ω–æ–π —Å–∏–≥–Ω–∞–ª</option>
                                    <option value="chirp">–ß–∏—Ä–ø</option>
                                    <option value="bell">–ö–æ–ª–æ–∫–æ–ª—å—á–∏–∫</option>
                                    <option value="ding">–î–∏–Ω—å</option>
                                    <option value="tick">–¢–∏–∫</option>
                                    <option value="soft-alert">–ú—è–≥–∫–∏–π —Å–∏–≥–Ω–∞–ª</option>
                                </optgroup>
                                <optgroup label="–í–∞—à–∏ –∑–≤—É–∫–∏" id="customSoundsGroupMinute"></optgroup>
                            </select>
                            <button class="sound-preview" id="soundMinutePreview">‚ñ∂</button>
                        </div>

                        <div class="custom-sounds-section">
                            <div class="settings-group-title">
                                <span class="icon">üéµ</span>
                                –í–∞—à–∏ –∑–≤—É–∫–∏
                            </div>
                            <div class="custom-sound-list" id="customSoundList"></div>
                            <div class="add-sound-row">
                                <button class="add-sound-btn" id="addSoundBtn">
                                    <span>‚ûï</span>
                                    <span>–î–æ–±–∞–≤–∏—Ç—å –∑–≤—É–∫</span>
                                </button>
                                <input type="file" class="hidden-file-input" id="soundFileInput" 
                                       accept="audio/mp3,audio/wav,audio/ogg,audio/mpeg,.mp3,.wav,.ogg">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
        </div>
    </div>

    <!-- FAQ Modal -->
    <div class="faq-modal" id="faqModal">
        <div class="faq-content">
            <div class="faq-header">
                <h2>üìñ –°–ø—Ä–∞–≤–∫–∞ –ø–æ Timer App</h2>
                <button class="faq-close" id="faqClose">&times;</button>
            </div>
            <div class="faq-body">
                <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
                <div class="faq-section">
                    <div class="faq-section-title">‚è±Ô∏è –û—Å–Ω–æ–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</div>
                    <div class="faq-item">
                        <div class="faq-question">–ö–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º—è?</div>
                        <div class="faq-answer">
                            <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–∞–π–¥–µ—Ä—ã <strong>–ß–∞—Å—ã</strong>, <strong>–ú–∏–Ω—É—Ç—ã</strong> –∏ <strong>–°–µ–∫—É–Ω–¥—ã</strong> –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ —Ç–∞–π–º–µ—Ä–∞.</p>
                            <p>–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ –ø—Ä–µ—Å–µ—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, 15, 30, 60 –º–∏–Ω—É—Ç) –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.</p>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–æ–º</div>
                        <div class="faq-answer">
                            <ul>
                                <li><strong>‚ñ∂ Start</strong> ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–∞–π–º–µ—Ä</li>
                                <li><strong>‚è∏ Pause</strong> ‚Äî –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (–≤—Ä–µ–º—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è)</li>
                                <li><strong>‚ñ† Stop</strong> ‚Äî –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —Å–±—Ä–æ—Å–∏—Ç—å —Ç–∞–π–º–µ—Ä</li>
                                <li><strong>+1 –º–∏–Ω</strong> ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –æ–¥–Ω—É –º–∏–Ω—É—Ç—É –∫ —Ç–µ–∫—É—â–µ–º—É –≤—Ä–µ–º–µ–Ω–∏</li>
                            </ul>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">–ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å –Ω–∏–∂–µ 0</div>
                        <div class="faq-answer">
                            <p>–ö–æ–≥–¥–∞ —ç—Ç–∞ –æ–ø—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞, —Ç–∞–π–º–µ—Ä –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –Ω—É–ª—è, –∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å—á–∏—Ç–∞—Ç—å –≤ –º–∏–Ω—É—Å.</p>
                            <ul>
                                <li>–í—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–æ –∑–Ω–∞–∫–æ–º –º–∏–Ω—É—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, -00:15)</li>
                                <li>–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏</li>
                                <li>–ó–≤—É–∫–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤—Å—ë —Ä–∞–≤–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 0</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- –û–∫–Ω–∞ -->
                <div class="faq-section">
                    <div class="faq-section-title">üñ•Ô∏è –û–∫–Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</div>
                    <div class="faq-item">
                        <div class="faq-question">Timer Widget (–≤–∏–¥–∂–µ—Ç —Ç–∞–π–º–µ—Ä–∞)</div>
                        <div class="faq-answer">
                            <p>–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π –≤–∏–¥–∂–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –ø–æ–≤–µ—Ä—Ö –ª—é–±–æ–≥–æ –æ–∫–Ω–∞.</p>
                            <ul>
                                <li>–ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ—Ç—Å—è –∑–∞ –ª—é–±—É—é –æ–±–ª–∞—Å—Ç—å</li>
                                <li>–ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—è–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –º—ã—à–∏</li>
                                <li>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é Ctrl+–∫–æ–ª–µ—Å–æ –º—ã—à–∏</li>
                            </ul>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">Clock Widget (–≤–∏–¥–∂–µ—Ç —á–∞—Å–æ–≤)</div>
                        <div class="faq-answer">
                            <p>–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Å—Ç–∏–ª–µ.</p>
                            <ul>
                                <li>–¢—Ä–∏ —Å—Ç–∏–ª—è: –∫—Ä—É–≥–æ–≤–æ–π, —Ü–∏—Ñ—Ä–æ–≤–æ–π LED, —Ñ–ª–∏–ø-—á–∞—Å—ã</li>
                                <li>–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –¥–∞—Ç–∞, —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å, —Å–µ–∫—É–Ω–¥—ã, 24—á —Ñ–æ—Ä–º–∞—Ç</li>
                                <li>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é Ctrl+–∫–æ–ª–µ—Å–æ –º—ã—à–∏</li>
                            </ul>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">Display (–ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π –¥–∏—Å–ø–ª–µ–π)</div>
                        <div class="faq-answer">
                            <p>–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞ –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π.</p>
                            <ul>
                                <li>–ù–∞–∂–º–∏—Ç–µ <strong>Esc</strong> –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è</li>
                                <li>–°—Ç–∏–ª—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö</li>
                                <li>–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- –°—Ç–∏–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
                <div class="faq-section">
                    <div class="faq-section-title">üé® –°—Ç–∏–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>
                    <div class="faq-item">
                        <div class="faq-question">–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–∏–ª–∏</div>
                        <div class="faq-answer">
                            <ul>
                                <li><strong>Circle (–ö—Ä—É–≥–æ–≤–æ–π)</strong> ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∫—Ä—É–≥–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º</li>
                                <li><strong>Digital (–¶–∏—Ñ—Ä–æ–≤–æ–π)</strong> ‚Äî LED-–¥–∏—Å–ø–ª–µ–π –≤ —Å—Ç–∏–ª–µ —Ä–µ—Ç—Ä–æ</li>
                                <li><strong>Flip (–§–ª–∏–ø)</strong> ‚Äî –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–∫–∏–¥–Ω—ã–µ —á–∞—Å—ã</li>
                            </ul>
                            <p>–°—Ç–∏–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –≤ —Å–µ–∫—Ü–∏–∏ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è".</p>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">–†–∞–∑–º–µ—Ä –∏ –º–∞—Å—à—Ç–∞–±</div>
                        <div class="faq-answer">
                            <ul>
                                <li><strong>–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞</strong> ‚Äî –¥–ª—è Digital –∏ Flip —Å—Ç–∏–ª–µ–π –Ω–∞ Display</li>
                                <li><strong>–ú–∞—Å—à—Ç–∞–± –≤–∏–¥–∂–µ—Ç–∞</strong> ‚Äî –¥–ª—è –≤–∏–¥–∂–µ—Ç–∞ —Ç–∞–π–º–µ—Ä–∞ (—Ç–∞–∫–∂–µ Ctrl+–∫–æ–ª–µ—Å–æ)</li>
                                <li><strong>–ú–∞—Å—à—Ç–∞–± —á–∞—Å–æ–≤</strong> ‚Äî –¥–ª—è –≤–∏–¥–∂–µ—Ç–∞ —á–∞—Å–æ–≤ (—Ç–∞–∫–∂–µ Ctrl+–∫–æ–ª–µ—Å–æ)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–∏—Å–ø–ª–µ—è -->
                <div class="faq-section">
                    <div class="faq-section-title">üì∫ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–∏—Å–ø–ª–µ—è</div>
                    <div class="faq-item">
                        <div class="faq-question">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Ä–µ–º–µ–Ω–∏</div>
                        <div class="faq-answer">
                            <p>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–∞—è –Ω–∞ –¥–∏—Å–ø–ª–µ–µ:</p>
                            <ul>
                                <li><strong>–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –±–ª–æ–∫–∏ –≤—Ä–µ–º–µ–Ω–∏</strong> ‚Äî –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤ —Å —Ç–µ–∫—É—â–∏–º –≤—Ä–µ–º–µ–Ω–µ–º, –¥–∞—Ç–æ–π –∏ —á–∞—Å–æ–≤—ã–º –ø–æ—è—Å–æ–º</li>
                                <li>–ë–ª–æ–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –ø–æ–¥ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å—Ç–∏–ª—å</li>
                            </ul>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ —Ä–∞–∑–º–µ—Ä</div>
                        <div class="faq-answer">
                            <ul>
                                <li><strong>–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ</strong> ‚Äî –≤—ã–±–æ—Ä –ø–æ–∑–∏—Ü–∏–∏ —Ç–∞–π–º–µ—Ä–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ (—Ü–µ–Ω—Ç—Ä, –≤–µ—Ä—Ö, –Ω–∏–∑ –∏ —Ç.–¥.)</li>
                                <li><strong>–†–∞–∑–º–µ—Ä –±–ª–æ–∫–æ–≤</strong> ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –≤—Ä–µ–º–µ–Ω–∏</li>
                                <li>–û–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤: –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏, —Å—Ç—Ä–∏–º—ã, –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</li>
                            </ul>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">–§–æ–Ω –¥–∏—Å–ø–ª–µ—è</div>
                        <div class="faq-answer">
                            <ul>
                                <li><strong>–¶–≤–µ—Ç —Ñ–æ–Ω–∞</strong> ‚Äî –≤—ã–±–æ—Ä —Å–ø–ª–æ—à–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞ —Ñ–æ–Ω–∞</li>
                                <li><strong>–°–≤–æ—è –ø–æ–¥–ª–æ–∂–∫–∞</strong> ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ñ–æ–Ω–∞</li>
                                <li>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç—ã: JPG, PNG, GIF, WebP</li>
                                <li>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ —Ä–∞–∑–º–µ—Ä —ç–∫—Ä–∞–Ω–∞</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Å–æ–≤ -->
                <div class="faq-section">
                    <div class="faq-section-title">üïê –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Å–æ–≤</div>
                    <div class="faq-item">
                        <div class="faq-question">–û–ø—Ü–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>
                        <div class="faq-answer">
                            <ul>
                                <li><strong>–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–∞—Ç—É</strong> ‚Äî –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã</li>
                                <li><strong>–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å</strong> ‚Äî –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–æ–Ω—ã</li>
                                <li><strong>–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–µ–∫—É–Ω–¥—ã</strong> ‚Äî —Å–µ–∫—É–Ω–¥—ã –≤ —Ü–∏—Ñ—Ä–æ–≤–æ–º —Å—Ç–∏–ª–µ</li>
                                <li><strong>24-—á–∞—Å–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç</strong> ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É 12/24—á —Ñ–æ—Ä–º–∞—Ç–æ–º</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- –ó–≤—É–∫–∏ -->
                <div class="faq-section">
                    <div class="faq-section-title">üîî –ó–≤—É–∫–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                    <div class="faq-item">
                        <div class="faq-question">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–≤—É–∫–æ–≤</div>
                        <div class="faq-answer">
                            <ul>
                                <li>–í—ã–±–µ—Ä–∏—Ç–µ –∑–≤—É–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –∑–≤—É–∫–æ–≤</li>
                                <li>–ù–∞–∂–º–∏—Ç–µ <strong>‚ñ∂ –¢–µ—Å—Ç</strong> –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è</li>
                                <li>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å —Å –ø–æ–º–æ—â—å—é —Å–ª–∞–π–¥–µ—Ä–∞</li>
                                <li>–ó–≤—É–∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ç–∞–π–º–µ—Ä–∞</li>
                            </ul>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤–æ–µ–≥–æ –∑–≤—É–∫–∞</div>
                        <div class="faq-answer">
                            <ul>
                                <li>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É <strong>üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å</strong> —Ä—è–¥–æ–º —Å –≤—ã–±–æ—Ä–æ–º –∑–≤—É–∫–∞</li>
                                <li>–í—ã–±–µ—Ä–∏—Ç–µ –∞—É–¥–∏–æ—Ñ–∞–π–ª —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (MP3, WAV, OGG)</li>
                                <li>–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π –∑–≤—É–∫ –ø–æ—è–≤–∏—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ –∫–∞–∫ "Custom Sound"</li>
                                <li>–ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –ª—é–±—É—é –º–µ–ª–æ–¥–∏—é –∏–ª–∏ –∑–≤—É–∫–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ -->
                <div class="faq-section">
                    <div class="faq-section-title">‚å®Ô∏è –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏</div>
                    <div class="faq-item">
                        <div class="faq-question">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–æ–º (NEW!)</div>
                        <div class="faq-answer">
                            <div class="faq-shortcuts">
                                <div class="shortcut"><span class="key">Space</span> <span class="shortcut-desc">–°—Ç–∞—Ä—Ç/–ü–∞—É–∑–∞</span></div>
                                <div class="shortcut"><span class="key">R</span> <span class="shortcut-desc">–°–±—Ä–æ—Å —Ç–∞–π–º–µ—Ä–∞</span></div>
                                <div class="shortcut"><span class="key">S</span> <span class="shortcut-desc">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∞–π–º–µ—Ä</span></div>
                                <div class="shortcut"><span class="key">1</span>-<span class="key">5</span> <span class="shortcut-desc">–ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–µ—Å–µ—Ç—ã (1, 5, 10, 15, 30 –º–∏–Ω)</span></div>
                            </div>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">–û–∫–Ω–∞ –∏ –≤–∏–¥–∂–µ—Ç—ã (NEW!)</div>
                        <div class="faq-answer">
                            <div class="faq-shortcuts">
                                <div class="shortcut"><span class="key">W</span> <span class="shortcut-desc">–û—Ç–∫—Ä—ã—Ç—å –≤–∏–¥–∂–µ—Ç —Ç–∞–π–º–µ—Ä–∞</span></div>
                                <div class="shortcut"><span class="key">D</span> <span class="shortcut-desc">–û—Ç–∫—Ä—ã—Ç—å –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π –¥–∏—Å–ø–ª–µ–π</span></div>
                                <div class="shortcut"><span class="key">Esc</span> <span class="shortcut-desc">–ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∏–¥–∂–µ—Ç—ã</span></div>
                                <div class="shortcut"><span class="key">F1</span> <span class="shortcut-desc">–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –ø–æ –∫–ª–∞–≤–∏—à–∞–º</span></div>
                            </div>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                        <div class="faq-answer">
                            <div class="faq-shortcuts">
                                <div class="shortcut"><span class="key">Ctrl</span> + <span class="key">–ö–æ–ª–µ—Å–æ</span> <span class="shortcut-desc">–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏–¥–∂–µ—Ç–æ–≤</span></div>
                                <div class="shortcut"><span class="key">–ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ</span> <span class="shortcut-desc">–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –æ–∫–Ω–∞</span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –°–æ–≤–µ—Ç—ã -->
                <div class="faq-section">
                    <div class="faq-section-title">üí° –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã</div>
                    <div class="faq-item">
                        <div class="faq-question">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é</div>
                        <div class="faq-answer">
                            <ul>
                                <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∏–¥–∂–µ—Ç –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–≤–µ—Ä—Ö –¥—Ä—É–≥–∏—Ö –æ–∫–æ–Ω</li>
                                <li>Display –∏–¥–µ–∞–ª–µ–Ω –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π –∏ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–π</li>
                                <li>–ö–Ω–æ–ø–∫–∞ <strong>+1 –º–∏–Ω</strong> —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Ç–∞–π–º–µ—Ä–∞</li>
                                <li>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</li>
                                <li>–í—Å–µ –æ–∫–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤–µ–∑–¥–µ</li>
                                <li><strong>NEW!</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–Ω–∞–∂–º–∏—Ç–µ F1)</li>
                                <li><strong>NEW!</strong> –ö–ª–∞–≤–∏—à–∏ 1-5 –±—ã—Å—Ç—Ä–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –≤—Ä–µ–º–µ–Ω–∏</li>
                                <li>–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏</li>
                            </ul>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</div>
                        <div class="faq-answer">
                            <ul>
                                <li>‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π</li>
                                <li>‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞ (XSS protection)</li>
                                <li>‚úÖ –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</li>
                                <li>‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ 10MB, –∞—É–¥–∏–æ –¥–æ 5MB</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- IPC Compatibility Layer (maps ipcRenderer to secure electronAPI) -->
    <script src="ipc-compat.js"></script>

    <script>
        // ipcRenderer —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ ipc-compat.js (–±–µ–∑–æ–ø–∞—Å–Ω–æ)

        const debounce = (fn, delay = 120) => {
            let t;
            return (...args) => {
                clearTimeout(t);
                t = setTimeout(() => fn(...args), delay);
            };
        };

        // FIX BUG-028: Loading indicator utilities
        const LoadingIndicator = {
            /**
             * Show fullscreen loading overlay
             * @param {string} message - Loading message to display
             * @returns {HTMLElement} - Overlay element (to remove later)
             */
            show(message = '–ó–∞–≥—Ä—É–∑–∫–∞...') {
                const overlay = document.createElement('div');
                overlay.className = 'loading-overlay';
                overlay.innerHTML = `
                    <div style="text-align: center;">
                        <div class="loading-spinner"></div>
                        <div class="loading-text">${message}</div>
                    </div>
                `;
                document.body.appendChild(overlay);
                return overlay;
            },

            /**
             * Hide loading overlay
             * @param {HTMLElement} overlay - Overlay element to remove
             */
            hide(overlay) {
                if (overlay && overlay.parentNode) {
                    overlay.parentNode.removeChild(overlay);
                }
            },

            /**
             * Show inline loading indicator in a button
             * @param {HTMLElement} button - Button element
             * @returns {HTMLElement} - Loader element
             */
            showInline(button) {
                if (!button) return null;

                button.disabled = true;
                button.classList.add('loading-button');

                const loader = document.createElement('span');
                loader.className = 'inline-loader';
                button.appendChild(loader);

                return loader;
            },

            /**
             * Hide inline loading indicator
             * @param {HTMLElement} button - Button element
             * @param {HTMLElement} loader - Loader element to remove
             */
            hideInline(button, loader) {
                if (!button) return;

                button.disabled = false;
                button.classList.remove('loading-button');

                if (loader && loader.parentNode) {
                    loader.parentNode.removeChild(loader);
                }
            },

            /**
             * Wrap async function with loading indicator
             * @param {Function} asyncFn - Async function to wrap
             * @param {string} message - Loading message
             * @returns {Function} - Wrapped function
             */
            wrap(asyncFn, message = '–ó–∞–≥—Ä—É–∑–∫–∞...') {
                return async (...args) => {
                    const overlay = this.show(message);
                    try {
                        return await asyncFn(...args);
                    } finally {
                        this.hide(overlay);
                    }
                };
            }
        };

        class TimerController {
            constructor() {
                this.totalSeconds = 0;
                this.remainingSeconds = 0;
                this.isRunning = false;
                this.isPaused = false;
                this.lastTimestamp = 0;
                this.wasFinished = false;
                this.currentBgMode = 'solid';

                // FIX BUG-023: Track active theme button to avoid querySelectorAll
                this.activeThemeButton = null;

                // –¢–µ–∫—É—â–∏–µ —Ü–≤–µ—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - –ø–µ—Ä–≤–∞—è —Ç–µ–º–∞)
                this.currentColors = {
                    timer: '#667eea',
                    progress: '#764ba2',
                    bg: '#0f0c29'
                };

                this.initElements();
                this.initTabs();
                this.initThemes();
                this.attachEvents();
                this.loadSettings();
                this.loadClockSettings();
                this.setupIPC();
                
                // –ê–≤—Ç–æ-—Ä–∞–∑–º–µ—Ä –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
                setTimeout(() => this.autoResizeWindow(), 100);
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
                setTimeout(() => {
                    this.pushDisplaySettings();
                    this.pushClockSettings();
                }, 200);
            }

            initElements() {
                this.controlTimeEl = document.getElementById('controlTime');
                this.statusDot = document.getElementById('statusDot');
                this.statusText = document.getElementById('statusText');
                this.startBtn = document.getElementById('startBtn');
                this.pauseBtn = document.getElementById('pauseBtn');
                this.resetBtn = document.getElementById('resetBtn');
                this.customMinutes = document.getElementById('customMinutes');
                this.customSeconds = document.getElementById('customSeconds');
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                this.allowNegativeEl = document.getElementById('allowNegative');
                this.soundMasterEl = document.getElementById('soundMasterEnabled');
                this.soundStartEl = document.getElementById('soundStartEnabled');
                this.soundEndEl = document.getElementById('soundEndEnabled');
                this.soundMinuteEl = document.getElementById('soundMinuteEnabled');
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
                this.displaySelectEl = document.getElementById('displaySelect');
                this.showTimeBlocksEl = document.getElementById('showTimeBlocks');
                this.timeLayoutPresetEl = document.getElementById('timeLayoutPreset');
                this.eventTimeInputEl = document.getElementById('eventTimeInput');
                this.endTimeInputEl = document.getElementById('endTimeInput');
                this.timeBlocksScaleEl = document.getElementById('timeBlocksScale');
                this.timeBlocksScaleValueEl = document.getElementById('timeBlocksScaleValue');
                this.timerStyleEl = document.getElementById('timerStyle');
                this.timerScaleEl = document.getElementById('timerScale');
                this.timerScaleValueEl = document.getElementById('timerScaleValue');
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–¥–∂–µ—Ç–∞ —á–∞—Å–æ–≤
                this.syncClockStyleEl = document.getElementById('syncClockStyle');
                this.clockStyleEl = document.getElementById('clockStyle');
                this.clockStyleRowEl = document.getElementById('clockStyleRow');
                this.clockAnalogNumbersRowEl = document.getElementById('clockAnalogNumbersRow');
                this.clockShowAnalogNumbersEl = document.getElementById('clockShowAnalogNumbers');
                this.clockShowDateEl = document.getElementById('clockShowDate');
                this.clockShowTimezoneEl = document.getElementById('clockShowTimezone');
                this.clockShowSecondsEl = document.getElementById('clockShowSeconds');
                this.clockFormat24hEl = document.getElementById('clockFormat24h');
                
                // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç–∏–ª–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–∞)
                this.syncClockStyle = true;
                
                // –ü—Ä–µ—Å–µ—Ç —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - "–†–∞–º–∫–∞"
                this.timeLayoutPreset = 'frame';
            }

            initTabs() {
                // –ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
                const settingsToggle = document.getElementById('settingsToggle');
                const advancedSettings = document.getElementById('advancedSettings');
                
                settingsToggle.addEventListener('click', () => {
                    settingsToggle.classList.toggle('open');
                    advancedSettings.classList.toggle('open');
                    
                    // –ò–∑–º–µ–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
                    setTimeout(() => {
                        this.autoResizeWindow();
                    }, 400);
                });

                // –¢–∞–±—ã –≤–Ω—É—Ç—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                        btn.classList.add('active');
                        const tabContent = document.getElementById(`tab-${btn.dataset.tab}`);
                        tabContent.classList.add('active');
                        
                        // –ê–≤—Ç–æ-—Ä–µ—Å–∞–π–∑ –ø—Ä–∏ —Å–º–µ–Ω–µ —Ç–∞–±–∞
                        setTimeout(() => this.autoResizeWindow(), 50);
                    });
                });

                // –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–µ—Å–µ—Ç—ã
                document.querySelectorAll('.quick-preset').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.quick-preset').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        const minutes = parseInt(btn.dataset.minutes);
                        this.sendCommand('set', { seconds: minutes * 60 });
                    });
                });

                // –†–µ–∂–∏–º —Ñ–æ–Ω–∞
                document.querySelectorAll('.bg-mode-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.bg-mode-btn').forEach(b => b.classList.remove('active'));
                        document.querySelectorAll('.bg-controls').forEach(c => c.classList.remove('active'));
                        btn.classList.add('active');
                        this.currentBgMode = btn.dataset.mode;
                        document.getElementById(`bg${this.capitalize(btn.dataset.mode)}Controls`).classList.add('active');
                        this.pushDisplaySettings();
                    });
                });
            }

            initThemes() {
                const themes = [
                    { name: '–°–∏–Ω–∏–π', t1: '#667eea', t2: '#764ba2', bg: '#0f0c29' },
                    { name: '–ù–µ–æ–Ω', t1: '#39ff14', t2: '#00ffa3', bg: '#0b2b1d' },
                    { name: '–ó–∞–∫–∞—Ç', t1: '#ff9966', t2: '#ff5e62', bg: '#1a0a1a' },
                    { name: '–û–∫–µ–∞–Ω', t1: '#36d1dc', t2: '#5b86e5', bg: '#0f2027' },
                    { name: '–ú—è—Ç–∞', t1: '#3cd3ad', t2: '#4cb8c4', bg: '#134e5e' },
                    { name: '–õ–∞–≤–∞–Ω–¥–∞', t1: '#b993d6', t2: '#8ca6db', bg: '#190a33' },
                    { name: '–°–æ–ª–Ω—Ü–µ', t1: '#f6d365', t2: '#fda085', bg: '#3b1d0f' },
                    { name: '–ù–æ—Ä–¥', t1: '#88c0d0', t2: '#81a1c1', bg: '#2e3440' }
                ];

                const grid = document.getElementById('themesGrid');
                themes.forEach((theme, i) => {
                    const btn = document.createElement('button');
                    btn.className = 'theme-btn';
                    btn.title = theme.name;
                    btn.style.setProperty('--t1', theme.t1);
                    btn.style.setProperty('--t2', theme.t2);
                    btn.addEventListener('click', () => {
                        // FIX BUG-023: Optimize - remove active from previous button only
                        if (this.activeThemeButton) {
                            this.activeThemeButton.classList.remove('active');
                        }
                        btn.classList.add('active');
                        this.activeThemeButton = btn;

                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ü–≤–µ—Ç–∞ —Ç–µ–º—ã
                        this.currentColors = {
                            timer: theme.t1,
                            progress: theme.t2,
                            bg: theme.bg
                        };
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–æ–Ω
                        document.getElementById('bgSolidColor').value = theme.bg;
                        document.getElementById('bgGrad1').value = theme.bg;
                        this.saveColors();
                        this.pushDisplaySettings();
                    });
                    grid.appendChild(btn);
                });
            }

            attachEvents() {
                // –ü—Ä–µ—Å–µ—Ç—ã –≤—Ä–µ–º–µ–Ω–∏
                document.querySelectorAll('.preset-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const minutes = parseInt(btn.dataset.minutes);
                        this.setTime(minutes * 60);
                    });
                });

                // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤—Ä—É—á–Ω—É—é
                document.getElementById('setCustomTime').addEventListener('click', () => {
                    // FIX BUG-011: –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
                    const minutesValue = this.customMinutes.value.trim();
                    const secondsValue = this.customSeconds.value.trim();

                    // –í–∞–ª–∏–¥–∞—Ü–∏—è –º–∏–Ω—É—Ç
                    const minutes = parseInt(minutesValue);
                    if (isNaN(minutes) || minutes < 0) {
                        this.showInputError(this.customMinutes, '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ –º–∏–Ω—É—Ç (‚â• 0)');
                        return;
                    }
                    if (minutes > 999) {
                        this.showInputError(this.customMinutes, '–ú–∞–∫—Å–∏–º—É–º 999 –º–∏–Ω—É—Ç');
                        return;
                    }
                    this.clearInputError(this.customMinutes);

                    // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–µ–∫—É–Ω–¥
                    const seconds = parseInt(secondsValue);
                    if (isNaN(seconds) || seconds < 0) {
                        this.showInputError(this.customSeconds, '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ —Å–µ–∫—É–Ω–¥ (0-59)');
                        return;
                    }
                    if (seconds > 59) {
                        this.showInputError(this.customSeconds, '–°–µ–∫—É–Ω–¥—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç 0 –¥–æ 59');
                        return;
                    }
                    this.clearInputError(this.customSeconds);

                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Ö–æ—Ç—å —á—Ç–æ-—Ç–æ
                    const totalSeconds = minutes * 60 + seconds;
                    if (totalSeconds === 0) {
                        this.showInputError(this.customMinutes, '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Ä–µ–º—è –±–æ–ª—å—à–µ 0');
                        return;
                    }

                    this.setTime(totalSeconds);
                });

                // Enter –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Ä–µ–º–µ–Ω–∏
                [this.customMinutes, this.customSeconds].forEach(el => {
                    el.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') {
                            document.getElementById('setCustomTime').click();
                        }
                    });
                });

                // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
                document.querySelectorAll('.adjust-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.adjustTime(parseInt(btn.dataset.seconds));
                    });
                });

                // –ì–ª–∞–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
                this.startBtn.addEventListener('click', () => this.start());
                this.pauseBtn.addEventListener('click', () => this.pause());
                this.resetBtn.addEventListener('click', () => this.reset());

                // –û–∫–Ω–∞
                document.getElementById('openWidgetBtn').addEventListener('click', () => {
                    ipcRenderer.send('open-widget');
                });
                document.getElementById('openClockBtn').addEventListener('click', () => {
                    ipcRenderer.send('open-clock-widget');
                    // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Å–æ–≤ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
                    setTimeout(() => this.pushClockSettings(), 500);
                });
                document.getElementById('openDisplayBtn').addEventListener('click', () => {
                    const displayIndex = this.displaySelectEl.value;
                    ipcRenderer.send('open-display', { displayIndex });
                });
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –º–æ–Ω–∏—Ç–æ—Ä–∞
                this.displaySelectEl.addEventListener('change', () => {
                    localStorage.setItem('selectedDisplay', this.displaySelectEl.value);
                });

                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ—Ä–∞—Å—Ö–æ–¥–∞
                this.allowNegativeEl.addEventListener('change', () => {
                    document.getElementById('overrunRow').style.display = 
                        this.allowNegativeEl.checked ? 'flex' : 'none';
                    this.saveExtSettings();
                });

                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–ª–æ–∫–æ–≤ –≤—Ä–µ–º–µ–Ω–∏
                this.showTimeBlocksEl.addEventListener('change', () => {
                    const show = this.showTimeBlocksEl.checked;
                    document.getElementById('timeBlocksSettings').style.display = show ? 'block' : 'none';
                    this.pushDisplaySettings();
                });
                
                this.timeLayoutPresetEl.addEventListener('change', () => {
                    this.timeLayoutPreset = this.timeLayoutPresetEl.value;
                    this.pushDisplaySettings();
                });
                
                this.eventTimeInputEl.addEventListener('change', () => this.pushDisplaySettings());
                this.endTimeInputEl.addEventListener('change', () => this.pushDisplaySettings());
                
                this.timeBlocksScaleEl.addEventListener('input', () => {
                    this.timeBlocksScaleValueEl.textContent = this.timeBlocksScaleEl.value + '%';
                    this.pushDisplaySettings();
                });
                
                this.timerStyleEl.addEventListener('change', () => {
                    this.pushDisplaySettings();
                    // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å—Ç–∏–ª—å —Å –≤–∏–¥–∂–µ—Ç–æ–º —á–∞—Å–æ–≤ –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
                    if (this.syncClockStyle) {
                        this.clockStyleEl.value = this.timerStyleEl.value;
                        this.updateClockAnalogNumbersVisibility();
                        ipcRenderer.send('clock-widget-set-style', this.timerStyleEl.value);
                    }
                });
                
                this.timerScaleEl.addEventListener('input', () => {
                    this.timerScaleValueEl.textContent = this.timerScaleEl.value + '%';
                    this.pushDisplaySettings();
                });

                // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç–∏–ª—è —á–∞—Å–æ–≤
                this.syncClockStyleEl.addEventListener('change', () => {
                    this.syncClockStyle = this.syncClockStyleEl.checked;
                    this.clockStyleRowEl.style.display = this.syncClockStyle ? 'none' : 'flex';
                    
                    if (this.syncClockStyle) {
                        // –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ - –ø—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª—å —Ç–∞–π–º–µ—Ä–∞ –∫ —á–∞—Å–∞–º
                        this.clockStyleEl.value = this.timerStyleEl.value;
                        ipcRenderer.send('clock-widget-set-style', this.timerStyleEl.value);
                    }
                    this.updateClockAnalogNumbersVisibility();
                    this.saveExtSettings();
                });

                // –û—Ç–¥–µ–ª—å–Ω—ã–π —Å—Ç–∏–ª—å —á–∞—Å–æ–≤
                this.clockStyleEl.addEventListener('change', () => {
                    if (!this.syncClockStyle) {
                        ipcRenderer.send('clock-widget-set-style', this.clockStyleEl.value);
                    }
                    this.updateClockAnalogNumbersVisibility();
                    this.saveExtSettings();
                });

                // –¶–∏—Ñ—Ä—ã –Ω–∞ —Ü–∏—Ñ–µ—Ä–±–ª–∞—Ç–µ –¥–ª—è —á–∞—Å–æ–≤
                this.clockShowAnalogNumbersEl.addEventListener('change', () => {
                    this.pushClockSettings();
                });

                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–¥–∂–µ—Ç–∞ —á–∞—Å–æ–≤
                this.clockShowDateEl.addEventListener('change', () => this.pushClockSettings());
                this.clockShowTimezoneEl.addEventListener('change', () => this.pushClockSettings());
                this.clockShowSecondsEl.addEventListener('change', () => this.pushClockSettings());
                this.clockFormat24hEl.addEventListener('change', () => this.pushClockSettings());

                // –§–æ–Ω –¥–∏—Å–ø–ª–µ—è
                ['bgSolidColor', 'bgGrad1', 'bgGrad2'].forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.addEventListener('input', debounce(() => this.pushDisplaySettings()));
                });
                const bgImageUrl = document.getElementById('bgImageUrl');
                if (bgImageUrl) bgImageUrl.addEventListener('change', () => this.pushDisplaySettings());

                // –°–±—Ä–æ—Å —Å—Ç–∏–ª—è
                const resetStyleBtn = document.getElementById('resetStyleBtn');
                if (resetStyleBtn) {
                    resetStyleBtn.addEventListener('click', () => {
                        document.getElementById('bgSolidColor').value = '#0f0c29';
                        document.getElementById('bgGrad1').value = '#0f0c29';
                        document.getElementById('bgGrad2').value = '#302b63';
                        // FIX BUG-023: Optimize - clear active button reference
                        if (this.activeThemeButton) {
                            this.activeThemeButton.classList.remove('active');
                            this.activeThemeButton = null;
                        }
                        // –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø–µ—Ä–≤—É—é —Ç–µ–º—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                        const firstTheme = document.querySelector('.theme-btn');
                        if (firstTheme) firstTheme.click();
                    });
                }

                // –ó–≤—É–∫–∏
                this.soundMasterEl.addEventListener('change', () => {
                    document.getElementById('soundSettings').style.opacity = 
                        this.soundMasterEl.checked ? '1' : '0.5';
                    this.saveExtSettings();
                });

                [this.soundStartEl, this.soundEndEl, this.soundMinuteEl].forEach(el => {
                    el.addEventListener('change', () => this.saveExtSettings());
                });

                ['soundStartPreset', 'soundEndPreset', 'soundMinutePreset'].forEach(id => {
                    document.getElementById(id).addEventListener('change', () => this.saveExtSettings());
                });

                // –ü—Ä–µ–≤—å—é –∑–≤—É–∫–æ–≤
                document.getElementById('soundStartPreview').addEventListener('click', () => this.previewSound('start'));
                document.getElementById('soundEndPreview').addEventListener('click', () => this.previewSound('end'));
                document.getElementById('soundMinutePreview').addEventListener('click', () => this.previewSound('minute'));

                // –õ–∏–º–∏—Ç –ø–µ—Ä–µ—Ä–∞—Å—Ö–æ–¥–∞
                document.getElementById('overrunLimit').addEventListener('change', () => this.saveExtSettings());

                // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∑–≤—É–∫–æ–≤
                document.getElementById('addSoundBtn').addEventListener('click', () => {
                    document.getElementById('soundFileInput').click();
                });

                document.getElementById('soundFileInput').addEventListener('change', (e) => {
                    this.handleSoundFileUpload(e);
                });

                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∑–≤—É–∫–æ–≤
                this.loadCustomSounds();

                // –õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–æ–Ω
                this.setupLocalBackground();
            }

            setupLocalBackground() {
                const preview = document.getElementById('localBgPreview');
                const placeholder = document.getElementById('localBgPlaceholder');
                const image = document.getElementById('localBgImage');
                const fileInput = document.getElementById('bgFileInput');
                const changeBtn = document.getElementById('changeBgBtn');
                const deleteBtn = document.getElementById('deleteBgBtn');
                const fitOptions = document.getElementById('bgFitOptions');
                const overlayRow = document.getElementById('bgOverlayRow');
                const overlaySlider = document.getElementById('bgOverlaySlider');
                const overlayValue = document.getElementById('bgOverlayValue');

                // –ö–ª–∏–∫ –ø–æ –ø—Ä–µ–≤—å—é - –æ—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
                preview.addEventListener('click', (e) => {
                    if (e.target === changeBtn || e.target === deleteBtn) return;
                    fileInput.click();
                });

                // –ö–Ω–æ–ø–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—å
                changeBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    fileInput.click();
                });

                // –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–∏—Ç—å
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.deleteLocalBackground();
                });

                // –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞
                fileInput.addEventListener('change', (e) => {
                    this.handleLocalBgUpload(e);
                });

                // –†–µ–∂–∏–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
                document.querySelectorAll('.bg-fit-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.bg-fit-btn').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        this.saveLocalBgSettings();
                        this.pushDisplaySettings();
                    });
                });

                // –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ
                overlaySlider.addEventListener('input', () => {
                    overlayValue.textContent = overlaySlider.value + '%';
                    this.saveLocalBgSettings();
                    this.pushDisplaySettings();
                });

                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π —Ñ–æ–Ω
                this.loadLocalBackground();
            }

            // FIX BUG-025, BUG-026: Validate file upload with MIME and magic bytes
            async validateImageFile(file) {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞
                const MAX_SIZE = 10 * 1024 * 1024; // 10 MB
                if (file.size > MAX_SIZE) {
                    return { valid: false, error: '–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (–º–∞–∫—Å–∏–º—É–º 10 –ú–ë)' };
                }

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ MIME type
                const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp', 'image/bmp'];
                if (!allowedTypes.includes(file.type)) {
                    return { valid: false, error: '–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø —Ñ–∞–π–ª–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ JPG, PNG, GIF, WebP –∏–ª–∏ BMP' };
                }

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ magic bytes (–ø–µ—Ä–≤—ã–µ –±–∞–π—Ç—ã —Ñ–∞–π–ª–∞)
                try {
                    const buffer = await file.slice(0, 12).arrayBuffer();
                    const bytes = new Uint8Array(buffer);

                    // –°–∏–≥–Ω–∞—Ç—É—Ä—ã —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
                    const signatures = {
                        jpeg: [[0xFF, 0xD8, 0xFF]],
                        png: [[0x89, 0x50, 0x4E, 0x47]],
                        gif: [[0x47, 0x49, 0x46, 0x38]],
                        webp: [[0x52, 0x49, 0x46, 0x46]], // RIFF
                        bmp: [[0x42, 0x4D]] // BM
                    };

                    let isValid = false;
                    for (const sigs of Object.values(signatures)) {
                        for (const sig of sigs) {
                            if (sig.every((byte, i) => bytes[i] === byte)) {
                                isValid = true;
                                break;
                            }
                        }
                        if (isValid) break;
                    }

                    if (!isValid) {
                        return { valid: false, error: '–§–∞–π–ª –ø–æ–≤—Ä–µ–∂–¥–µ–Ω –∏–ª–∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º' };
                    }
                } catch (error) {
                    return { valid: false, error: '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ñ–∞–π–ª–∞' };
                }

                return { valid: true };
            }

            async handleLocalBgUpload(event) {
                const file = event.target.files[0];
                if (!file) return;

                // FIX BUG-028: Show loading indicator during file processing
                const loadingOverlay = LoadingIndicator.show('–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...');

                try {
                    // FIX BUG-025, BUG-026: Validate file before upload
                    const validation = await this.validateImageFile(file);
                    if (!validation.valid) {
                        alert(validation.error);
                        event.target.value = ''; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º input
                        LoadingIndicator.hide(loadingOverlay);
                        return;
                    }

                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const base64 = e.target.result;

                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                        localStorage.setItem('localBgImage', base64);

                        // –û–±–Ω–æ–≤–ª—è–µ–º UI
                        this.showLocalBgPreview(base64);

                        // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                        this.pushDisplaySettings();

                        // Hide loading indicator
                        LoadingIndicator.hide(loadingOverlay);
                    };

                    reader.onerror = () => {
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞');
                        event.target.value = '';
                        LoadingIndicator.hide(loadingOverlay);
                    };

                    reader.readAsDataURL(file);
                    event.target.value = ''; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º input
                } catch (error) {
                    alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–∞');
                    LoadingIndicator.hide(loadingOverlay);
                    event.target.value = '';
                }
            }

            showLocalBgPreview(base64) {
                const preview = document.getElementById('localBgPreview');
                const placeholder = document.getElementById('localBgPlaceholder');
                const image = document.getElementById('localBgImage');
                const fitOptions = document.getElementById('bgFitOptions');
                const overlayRow = document.getElementById('bgOverlayRow');

                image.src = base64;
                image.style.display = 'block';
                placeholder.style.display = 'none';
                preview.classList.add('has-image');
                fitOptions.style.display = 'flex';
                overlayRow.style.display = 'flex';
            }

            hideLocalBgPreview() {
                const preview = document.getElementById('localBgPreview');
                const placeholder = document.getElementById('localBgPlaceholder');
                const image = document.getElementById('localBgImage');
                const fitOptions = document.getElementById('bgFitOptions');
                const overlayRow = document.getElementById('bgOverlayRow');

                image.src = '';
                image.style.display = 'none';
                placeholder.style.display = 'block';
                preview.classList.remove('has-image');
                fitOptions.style.display = 'none';
                overlayRow.style.display = 'none';
            }

            loadLocalBackground() {
                const savedBg = localStorage.getItem('localBgImage');
                const savedSettings = JSON.parse(localStorage.getItem('localBgSettings') || '{}');
                
                if (savedBg) {
                    this.showLocalBgPreview(savedBg);
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                    if (savedSettings.fit) {
                        document.querySelectorAll('.bg-fit-btn').forEach(b => {
                            b.classList.toggle('active', b.dataset.fit === savedSettings.fit);
                        });
                    }
                    if (savedSettings.overlay !== undefined) {
                        document.getElementById('bgOverlaySlider').value = savedSettings.overlay;
                        document.getElementById('bgOverlayValue').textContent = savedSettings.overlay + '%';
                    }
                }
            }

            deleteLocalBackground() {
                localStorage.removeItem('localBgImage');
                localStorage.removeItem('localBgSettings');
                this.hideLocalBgPreview();
                
                // –ï—Å–ª–∏ –±—ã–ª –≤—ã–±—Ä–∞–Ω —Ä–µ–∂–∏–º local, –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ solid
                if (this.currentBgMode === 'local') {
                    document.querySelectorAll('.bg-mode-btn').forEach(b => b.classList.remove('active'));
                    document.querySelector('.bg-mode-btn[data-mode="solid"]').classList.add('active');
                    document.querySelectorAll('.bg-controls').forEach(c => c.classList.remove('active'));
                    document.getElementById('bgSolidControls').classList.add('active');
                    this.currentBgMode = 'solid';
                }
                
                this.pushDisplaySettings();
            }

            saveLocalBgSettings() {
                const activeBtn = document.querySelector('.bg-fit-btn.active');
                const overlay = document.getElementById('bgOverlaySlider').value;
                
                localStorage.setItem('localBgSettings', JSON.stringify({
                    fit: activeBtn ? activeBtn.dataset.fit : 'cover',
                    overlay: parseInt(overlay)
                }));
            }

            loadSettings() {
                // –ó–∞–≥—Ä—É–∑–∫–∞ —Ü–≤–µ—Ç–æ–≤
                const savedColors = localStorage.getItem('timerColors');
                if (savedColors) {
                    const c = JSON.parse(savedColors);
                    this.currentColors = {
                        timer: c.timer || '#667eea',
                        progress: c.progress || '#764ba2',
                        bg: c.bg || '#0f0c29'
                    };
                }

                // –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
                const ext = JSON.parse(localStorage.getItem('displayExtSettings') || '{}');
                
                this.allowNegativeEl.checked = !!ext.allowNegative;
                document.getElementById('overrunRow').style.display = ext.allowNegative ? 'flex' : 'none';
                
                if (ext.overrunLimitSeconds != null) {
                    const mm = String(Math.floor(ext.overrunLimitSeconds / 60)).padStart(2, '0');
                    const ss = String(ext.overrunLimitSeconds % 60).padStart(2, '0');
                    document.getElementById('overrunLimit').value = `${mm}:${ss}`;
                }

                this.soundMasterEl.checked = ext.soundMasterEnabled !== false;
                this.soundStartEl.checked = !!ext.soundStartEnabled;
                this.soundEndEl.checked = ext.soundEndEnabled !== false;
                this.soundMinuteEl.checked = !!ext.soundMinuteEnabled;

                document.getElementById('soundStartPreset').value = ext.soundStartPreset || 'none';
                document.getElementById('soundEndPreset').value = ext.soundEndPreset || 'none';
                document.getElementById('soundMinutePreset').value = ext.soundMinutePreset || 'none';

                document.getElementById('bgSolidColor').value = ext.bgSolid || '#0f0c29';
                document.getElementById('bgGrad1').value = ext.bgGrad1 || '#0f0c29';
                document.getElementById('bgGrad2').value = ext.bgGrad2 || '#302b63';
                document.getElementById('bgImageUrl').value = ext.bgImageUrl || '';

                // –†–µ–∂–∏–º —Ñ–æ–Ω–∞
                const bgMode = ext.bgMode || 'solid';
                this.currentBgMode = bgMode;
                document.querySelectorAll('.bg-mode-btn').forEach(b => {
                    b.classList.toggle('active', b.dataset.mode === bgMode);
                });
                document.querySelectorAll('.bg-controls').forEach(c => c.classList.remove('active'));
                document.getElementById(`bg${this.capitalize(bgMode)}Controls`).classList.add('active');
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–ª–æ–∫–æ–≤ –≤—Ä–µ–º–µ–Ω–∏
                this.showTimeBlocksEl.checked = !!ext.showTimeBlocks;
                document.getElementById('timeBlocksSettings').style.display = ext.showTimeBlocks ? 'block' : 'none';
                this.timeLayoutPreset = ext.timeLayoutPreset || 'frame';
                this.timeLayoutPresetEl.value = this.timeLayoutPreset;
                this.eventTimeInputEl.value = ext.eventTime || '10:00';
                this.endTimeInputEl.value = ext.endTime || '12:00';
                this.timeBlocksScaleEl.value = ext.timeBlocksScale || 100;
                this.timeBlocksScaleValueEl.textContent = (ext.timeBlocksScale || 100) + '%';
                
                this.timerStyleEl.value = ext.timerStyle || 'circle';
                this.timerScaleEl.value = ext.timerScale || 100;
                this.timerScaleValueEl.textContent = (ext.timerScale || 100) + '%';
                
                // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç–∏–ª—è —á–∞—Å–æ–≤
                this.syncClockStyle = ext.syncClockStyle !== false; // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é true
                this.syncClockStyleEl.checked = this.syncClockStyle;
                this.clockStyleRowEl.style.display = this.syncClockStyle ? 'none' : 'flex';
                this.clockStyleEl.value = ext.clockStyle || ext.timerStyle || 'circle';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å –æ–ø—Ü–∏–∏ —Ü–∏—Ñ—Ä –¥–ª—è —á–∞—Å–æ–≤
                this.updateClockAnalogNumbersVisibility();
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å—Ç–∏–ª—å —á–∞—Å–∞–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
                const clockStyleToSend = this.syncClockStyle ? this.timerStyleEl.value : this.clockStyleEl.value;
                setTimeout(() => {
                    ipcRenderer.send('clock-widget-set-style', clockStyleToSend);
                }, 500);
            }

            saveColors() {
                localStorage.setItem('timerColors', JSON.stringify(this.currentColors));
                ipcRenderer.send('colors-update', this.currentColors);
            }

            saveExtSettings() {
                const overrunVal = document.getElementById('overrunLimit').value.trim();
                const [mm = '0', ss = '0'] = overrunVal.split(':');
                const overrunSecs = Math.max(0, parseInt(mm) || 0) * 60 + Math.max(0, Math.min(59, parseInt(ss) || 0));

                const settings = {
                    allowNegative: this.allowNegativeEl.checked,
                    overrunLimitSeconds: overrunSecs,
                    soundMasterEnabled: this.soundMasterEl.checked,
                    soundStartEnabled: this.soundStartEl.checked,
                    soundEndEnabled: this.soundEndEl.checked,
                    soundMinuteEnabled: this.soundMinuteEl.checked,
                    soundStartPreset: document.getElementById('soundStartPreset').value,
                    soundEndPreset: document.getElementById('soundEndPreset').value,
                    soundMinutePreset: document.getElementById('soundMinutePreset').value,
                    bgMode: this.currentBgMode,
                    bgSolid: document.getElementById('bgSolidColor').value,
                    bgGrad1: document.getElementById('bgGrad1').value,
                    bgGrad2: document.getElementById('bgGrad2').value,
                    bgImageUrl: document.getElementById('bgImageUrl').value,
                    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–ª–æ–∫–æ–≤ –≤—Ä–µ–º–µ–Ω–∏
                    showTimeBlocks: this.showTimeBlocksEl.checked,
                    timeLayoutPreset: this.timeLayoutPreset,
                    eventTime: this.eventTimeInputEl.value,
                    endTime: this.endTimeInputEl.value,
                    timeBlocksScale: parseInt(this.timeBlocksScaleEl.value),
                    timerStyle: this.timerStyleEl.value,
                    timerScale: parseInt(this.timerScaleEl.value),
                    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç–∏–ª—è —á–∞—Å–æ–≤
                    syncClockStyle: this.syncClockStyle,
                    clockStyle: this.clockStyleEl.value
                };

                const prev = JSON.parse(localStorage.getItem('displayExtSettings') || '{}');
                localStorage.setItem('displayExtSettings', JSON.stringify({ ...prev, ...settings }));
            }

            pushDisplaySettings() {
                this.saveExtSettings();
                
                // –ü–æ–ª—É—á–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–æ–Ω –∏ –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                const localBgImage = localStorage.getItem('localBgImage') || '';
                const localBgSettings = JSON.parse(localStorage.getItem('localBgSettings') || '{}');
                
                const settings = {
                    clockStyle: 'circle',
                    bgMode: this.currentBgMode,
                    bgSolid: document.getElementById('bgSolidColor').value,
                    bgGrad1: document.getElementById('bgGrad1').value,
                    bgGrad2: document.getElementById('bgGrad2').value,
                    bgImageUrl: document.getElementById('bgImageUrl').value,
                    // –õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–æ–Ω
                    bgLocalImage: this.currentBgMode === 'local' ? localBgImage : '',
                    bgLocalFit: localBgSettings.fit || 'cover',
                    bgLocalOverlay: localBgSettings.overlay || 30,
                    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–ª–æ–∫–æ–≤ –≤—Ä–µ–º–µ–Ω–∏
                    showTimeBlocks: this.showTimeBlocksEl.checked,
                    timeLayoutPreset: this.timeLayoutPreset,
                    eventTime: this.eventTimeInputEl.value,
                    endTime: this.endTimeInputEl.value,
                    timeBlocksScale: parseInt(this.timeBlocksScaleEl.value),
                    timerStyle: this.timerStyleEl.value,
                    timerScale: parseInt(this.timerScaleEl.value)
                };
                ipcRenderer.send('display-settings-update', settings);
            }

            updateClockAnalogNumbersVisibility() {
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π —Å—Ç–∏–ª—å —á–∞—Å–æ–≤
                const clockStyle = this.syncClockStyle ? this.timerStyleEl.value : this.clockStyleEl.value;
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–ø—Ü–∏—é —Ü–∏—Ñ—Ä —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–Ω–∞–ª–æ–≥–æ–≤–æ–≥–æ —Å—Ç–∏–ª—è
                if (this.clockAnalogNumbersRowEl) {
                    this.clockAnalogNumbersRowEl.style.display = clockStyle === 'analog' ? 'flex' : 'none';
                }
            }

            pushClockSettings() {
                const settings = {
                    showDate: this.clockShowDateEl.checked,
                    showTimezone: this.clockShowTimezoneEl.checked,
                    showSeconds: this.clockShowSecondsEl.checked,
                    format24h: this.clockFormat24hEl.checked,
                    showNumbers: this.clockShowAnalogNumbersEl.checked
                };
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                localStorage.setItem('clockWidgetSettings', JSON.stringify(settings));
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –≤–∏–¥–∂–µ—Ç —á–∞—Å–æ–≤
                ipcRenderer.send('clock-widget-settings', settings);
            }

            loadClockSettings() {
                const settings = JSON.parse(localStorage.getItem('clockWidgetSettings') || '{}');
                
                this.clockShowDateEl.checked = !!settings.showDate;
                this.clockShowTimezoneEl.checked = !!settings.showTimezone;
                this.clockShowSecondsEl.checked = settings.showSeconds !== false;
                this.clockFormat24hEl.checked = settings.format24h !== false;
                this.clockShowAnalogNumbersEl.checked = !!settings.showNumbers;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å –æ–ø—Ü–∏–∏ —Ü–∏—Ñ—Ä
                this.updateClockAnalogNumbersVisibility();
            }

            setupIPC() {
                ipcRenderer.send('get-timer-state');
                ipcRenderer.send('get-displays');

                ipcRenderer.on('displays-list', (event, displays) => {
                    this.updateDisplaysList(displays);
                });

                ipcRenderer.on('timer-state', (event, state) => {
                    if (state.timestamp && state.timestamp <= this.lastTimestamp) return;
                    this.lastTimestamp = state.timestamp || Date.now();

                    const wasFinishedBefore = this.wasFinished;
                    this.totalSeconds = state.totalSeconds;
                    this.remainingSeconds = state.remainingSeconds;
                    this.isRunning = state.isRunning;
                    this.isPaused = state.isPaused;
                    this.wasFinished = !!state.finished;

                    this.updateDisplay();
                    this.updateControls();

                    // –ó–≤—É–∫ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç–∞–π–º–µ—Ä–∞
                    if (state.finished && !wasFinishedBefore) {
                        console.log('Timer finished! Sound enabled:', this.soundEndEl.checked, 'Master:', this.soundMasterEl.checked);
                        if (this.soundEndEl.checked) {
                            this.playSound('end');
                        }
                    }
                });

                ipcRenderer.on('timer-minute', () => {
                    if (this.soundMinuteEl.checked) {
                        this.playSound('minute');
                    }
                });
            }

            // –ö–æ–º–∞–Ω–¥—ã —Ç–∞–π–º–µ—Ä–∞
            getConfig() {
                const overrunVal = document.getElementById('overrunLimit').value.trim();
                const [mm = '0', ss = '0'] = overrunVal.split(':');
                return {
                    allowNegative: this.allowNegativeEl.checked,
                    overrunLimitSeconds: Math.max(0, parseInt(mm) || 0) * 60 + Math.max(0, parseInt(ss) || 0)
                };
            }

            sendCommand(type, extra = {}) {
                const cfg = this.getConfig();
                ipcRenderer.send('timer-command', { type, ...cfg, ...extra });
            }

            setTime(seconds) {
                if (this.isRunning) return;
                this.sendCommand('set', { seconds: Math.max(0, seconds) });
            }

            adjustTime(seconds) {
                this.sendCommand('adjust', { deltaSeconds: seconds });
            }

            start() {
                if (this.remainingSeconds <= 0 && !this.getConfig().allowNegative) {
                    // –ù–µ–±–æ–ª—å—à–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –æ—à–∏–±–∫–∏
                    this.controlTimeEl.style.animation = 'shake 0.3s';
                    setTimeout(() => this.controlTimeEl.style.animation = '', 300);
                    return;
                }
                this.sendCommand('start');
                if (this.soundStartEl.checked) this.playSound('start');
            }

            pause() {
                this.sendCommand('pause');
            }

            reset() {
                this.sendCommand('reset');
            }

            // FIX BUG-011: –ú–µ—Ç–æ–¥—ã –¥–ª—è –ø–æ–∫–∞–∑–∞ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
            showInputError(inputElement, message) {
                if (!inputElement) return;

                // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –æ—à–∏–±–∫–∏ –∫ input
                inputElement.classList.add('input-error');

                // –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
                let errorDiv = inputElement.nextElementSibling;
                if (!errorDiv || !errorDiv.classList.contains('error-message')) {
                    errorDiv = document.createElement('div');
                    errorDiv.className = 'error-message';
                    inputElement.parentNode.insertBefore(errorDiv, inputElement.nextSibling);
                }
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';

                // –ù–µ–±–æ–ª—å—à–∞—è –∞–Ω–∏–º–∞—Ü–∏—è shake
                inputElement.style.animation = 'shake 0.3s';
                setTimeout(() => inputElement.style.animation = '', 300);
            }

            clearInputError(inputElement) {
                if (!inputElement) return;

                inputElement.classList.remove('input-error');
                const errorDiv = inputElement.nextElementSibling;
                if (errorDiv && errorDiv.classList.contains('error-message')) {
                    errorDiv.style.display = 'none';
                }
            }

            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateDisplay() {
                this.controlTimeEl.textContent = this.formatTime(this.remainingSeconds);
                
                // –¶–≤–µ—Ç–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è –≤—Ä–µ–º–µ–Ω–∏
                this.controlTimeEl.classList.remove('warning', 'danger');
                const isOvertime = this.remainingSeconds < 0;
                if (isOvertime) {
                    this.controlTimeEl.classList.add('danger');
                } else if (this.totalSeconds > 0) {
                    const percentLeft = (this.remainingSeconds / this.totalSeconds) * 100;
                    if (percentLeft <= 10 && percentLeft > 0) {
                        this.controlTimeEl.classList.add('danger');
                    } else if (percentLeft <= 25) {
                        this.controlTimeEl.classList.add('warning');
                    }
                }
                
                this.statusDot.className = 'status-dot';
                if (this.wasFinished || (this.remainingSeconds <= 0 && this.totalSeconds > 0 && !this.isRunning)) {
                    this.statusDot.classList.add('finished');
                    this.statusText.textContent = '–ó–∞–≤–µ—Ä—à–µ–Ω–æ';
                } else if (this.isRunning) {
                    this.statusDot.classList.add('running');
                    this.statusText.textContent = this.remainingSeconds < 0 ? '–ü–µ—Ä–µ—Ä–∞—Å—Ö–æ–¥' : '–ê–∫—Ç–∏–≤–µ–Ω';
                } else if (this.isPaused) {
                    this.statusDot.classList.add('paused');
                    this.statusText.textContent = '–ü–∞—É–∑–∞';
                } else {
                    this.statusText.textContent = '–ì–æ—Ç–æ–≤';
                }
            }

            updateControls() {
                this.startBtn.disabled = this.isRunning;
                this.pauseBtn.disabled = !this.isRunning;
            }

            updateDisplaysList(displays) {
                const select = this.displaySelectEl;
                const savedDisplay = localStorage.getItem('selectedDisplay') || 'auto';
                
                // –û—á–∏—â–∞–µ–º –∏ –¥–æ–±–∞–≤–ª—è–µ–º –æ–ø—Ü–∏—é "–ê–≤—Ç–æ"
                select.innerHTML = '<option value="auto" style="background: #1a1a2e;">üñ•Ô∏è –ê–≤—Ç–æ</option>';
                
                displays.forEach((display, index) => {
                    const option = document.createElement('option');
                    option.value = index.toString();
                    option.style.background = '#1a1a2e';
                    
                    const isPrimary = display.bounds.x === 0 && display.bounds.y === 0;
                    const label = isPrimary ? 'üñ•Ô∏è –û—Å–Ω–æ–≤–Ω–æ–π' : `üñ•Ô∏è –ú–æ–Ω–∏—Ç–æ—Ä ${index + 1}`;
                    const size = `${display.bounds.width}√ó${display.bounds.height}`;
                    
                    option.textContent = `${label} (${size})`;
                    select.appendChild(option);
                });
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–±–æ—Ä
                if (savedDisplay && select.querySelector(`option[value="${savedDisplay}"]`)) {
                    select.value = savedDisplay;
                }
            }

            autoResizeWindow() {
                // –ò–∑–º–µ—Ä—è–µ–º —Ä–µ–∞–ª—å–Ω—É—é –≤—ã—Å–æ—Ç—É –≤—Å–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                const panel = document.querySelector('.control-panel');
                
                // –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∞–ª—å–Ω—É—é –≤—ã—Å–æ—Ç—É –ø–∞–Ω–µ–ª–∏ + –æ—Ç—Å—Ç—É–ø—ã + –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ–∫–Ω–∞
                const panelHeight = panel.getBoundingClientRect().height;
                const extra = 75; // –æ—Ç—Å—Ç—É–ø—ã + –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ–∫–Ω–∞ Windows + –∑–∞–ø–∞—Å
                
                const neededHeight = Math.ceil(panelHeight + extra);
                
                ipcRenderer.send('resize-control-window', { 
                    width: 420, 
                    height: neededHeight
                });
            }

            formatTime(seconds) {
                const neg = seconds < 0;
                const abs = Math.abs(seconds);
                const h = Math.floor(abs / 3600);
                const m = Math.floor((abs % 3600) / 60);
                const s = abs % 60;
                
                if (h > 0) {
                    return `${neg ? '-' : ''}${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
                }
                return `${neg ? '-' : ''}${String(Math.floor(abs / 60)).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
            }

            // FIX BUG-020: Add async/await for async operations
            async playSound(type) {
                if (!this.soundMasterEl.checked) return;

                const presetId = `sound${this.capitalize(type)}Preset`;
                const preset = document.getElementById(presetId)?.value || 'none';

                console.log('Playing sound:', type, 'Preset:', preset);

                if (preset === 'none') {
                    await this.beep(880, 0.15);
                    return;
                }

                await this.playPreset(preset);
            }

            async previewSound(type) {
                const presetId = `sound${this.capitalize(type)}Preset`;
                const preset = document.getElementById(presetId)?.value || 'none';

                if (preset === 'none') {
                    await this.beep(880, 0.15);
                } else {
                    await this.playPreset(preset);
                }
            }

            async playPreset(name) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ª–∏ —ç—Ç–æ –∑–≤—É–∫
                if (name.startsWith('custom:')) {
                    await this.playCustomSound(name.replace('custom:', ''));
                    return;
                }

                const ctx = new (window.AudioContext || window.webkitAudioContext)();
                // –í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º AudioContext –µ—Å–ª–∏ –æ–Ω –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
                if (ctx.state === 'suspended') {
                    await ctx.resume();
                }
                const g = ctx.createGain();
                g.connect(ctx.destination);
                g.gain.value = 0.0001;
                const now = ctx.currentTime;

                const beep = (freq, start, dur, type = 'sine') => {
                    const o = ctx.createOscillator();
                    o.type = type;
                    o.frequency.value = freq;
                    o.connect(g);
                    g.gain.setValueAtTime(0.0001, start);
                    g.gain.exponentialRampToValueAtTime(0.25, start + 0.01);
                    o.start(start);
                    g.gain.exponentialRampToValueAtTime(0.0001, start + dur - 0.01);
                    o.stop(start + dur);
                };

                const multiBeep = (freq, count, interval, dur) => {
                    for (let i = 0; i < count; i++) {
                        beep(freq, now + i * interval, dur);
                    }
                };

                switch (name) {
                    case 'beep-short': 
                        beep(880, now, 0.15); 
                        break;
                    case 'beep-long': 
                        beep(660, now, 0.4); 
                        break;
                    case 'triple': 
                        beep(880, now, 0.12);
                        beep(980, now + 0.16, 0.12);
                        beep(1100, now + 0.32, 0.18);
                        break;
                    case 'chirp': {
                        const o = ctx.createOscillator();
                        o.type = 'sawtooth';
                        o.connect(g);
                        g.gain.setValueAtTime(0.0001, now);
                        g.gain.exponentialRampToValueAtTime(0.2, now + 0.02);
                        o.frequency.setValueAtTime(400, now);
                        o.frequency.exponentialRampToValueAtTime(1200, now + 0.25);
                        o.start(now);
                        g.gain.exponentialRampToValueAtTime(0.0001, now + 0.27);
                        o.stop(now + 0.28);
                        break;
                    }
                    case 'bell': {
                        // –ö–æ–ª–æ–∫–æ–ª—å—á–∏–∫
                        [1975, 2637, 3520].forEach((freq, i) => {
                            const o = ctx.createOscillator();
                            o.type = 'sine';
                            o.frequency.value = freq;
                            const env = ctx.createGain();
                            o.connect(env);
                            env.connect(ctx.destination);
                            env.gain.setValueAtTime(0.0001, now);
                            env.gain.exponentialRampToValueAtTime(0.15 / (i + 1), now + 0.01);
                            env.gain.exponentialRampToValueAtTime(0.0001, now + 0.8);
                            o.start(now);
                            o.stop(now + 0.85);
                        });
                        break;
                    }
                    case 'ding': {
                        // –î–∏–Ω—å
                        const o = ctx.createOscillator();
                        o.type = 'sine';
                        o.frequency.value = 2093;
                        o.connect(g);
                        g.gain.setValueAtTime(0.0001, now);
                        g.gain.exponentialRampToValueAtTime(0.3, now + 0.005);
                        g.gain.exponentialRampToValueAtTime(0.0001, now + 0.6);
                        o.start(now);
                        o.stop(now + 0.65);
                        break;
                    }
                    case 'whoosh': {
                        // –°–≤–∏—Å—Ç
                        const o = ctx.createOscillator();
                        o.type = 'sawtooth';
                        const filter = ctx.createBiquadFilter();
                        filter.type = 'bandpass';
                        filter.Q.value = 2;
                        o.connect(filter);
                        filter.connect(g);
                        g.gain.setValueAtTime(0.0001, now);
                        g.gain.exponentialRampToValueAtTime(0.15, now + 0.05);
                        o.frequency.setValueAtTime(200, now);
                        o.frequency.exponentialRampToValueAtTime(2000, now + 0.3);
                        filter.frequency.setValueAtTime(500, now);
                        filter.frequency.exponentialRampToValueAtTime(3000, now + 0.3);
                        g.gain.exponentialRampToValueAtTime(0.0001, now + 0.35);
                        o.start(now);
                        o.stop(now + 0.4);
                        break;
                    }
                    case 'click': {
                        // –ö–ª–∏–∫
                        const o = ctx.createOscillator();
                        o.type = 'square';
                        o.frequency.value = 1000;
                        o.connect(g);
                        g.gain.setValueAtTime(0.3, now);
                        g.gain.exponentialRampToValueAtTime(0.0001, now + 0.03);
                        o.start(now);
                        o.stop(now + 0.04);
                        break;
                    }
                    case 'alarm': {
                        // –ë—É–¥–∏–ª—å–Ω–∏–∫
                        for (let i = 0; i < 4; i++) {
                            beep(880, now + i * 0.25, 0.12);
                            beep(660, now + i * 0.25 + 0.12, 0.12);
                        }
                        break;
                    }
                    case 'fanfare': {
                        // –§–∞–Ω—Ñ–∞—Ä—ã
                        const notes = [523, 659, 784, 1047, 784, 1047];
                        notes.forEach((freq, i) => {
                            beep(freq, now + i * 0.15, 0.14);
                        });
                        break;
                    }
                    case 'gong': {
                        // –ì–æ–Ω–≥
                        const o1 = ctx.createOscillator();
                        const o2 = ctx.createOscillator();
                        o1.type = 'sine';
                        o2.type = 'sine';
                        o1.frequency.value = 110;
                        o2.frequency.value = 165;
                        const gongGain = ctx.createGain();
                        o1.connect(gongGain);
                        o2.connect(gongGain);
                        gongGain.connect(ctx.destination);
                        gongGain.gain.setValueAtTime(0.0001, now);
                        gongGain.gain.exponentialRampToValueAtTime(0.25, now + 0.02);
                        gongGain.gain.exponentialRampToValueAtTime(0.0001, now + 2);
                        o1.start(now);
                        o2.start(now);
                        o1.stop(now + 2.1);
                        o2.stop(now + 2.1);
                        break;
                    }
                    case 'tick': {
                        // –¢–∏–∫
                        const o = ctx.createOscillator();
                        o.type = 'square';
                        o.frequency.value = 800;
                        o.connect(g);
                        g.gain.setValueAtTime(0.2, now);
                        g.gain.exponentialRampToValueAtTime(0.0001, now + 0.05);
                        o.start(now);
                        o.stop(now + 0.06);
                        break;
                    }
                    case 'soft-alert': {
                        // –ú—è–≥–∫–∏–π —Å–∏–≥–Ω–∞–ª
                        [440, 554, 659].forEach((freq, i) => {
                            const o = ctx.createOscillator();
                            o.type = 'sine';
                            o.frequency.value = freq;
                            const env = ctx.createGain();
                            o.connect(env);
                            env.connect(ctx.destination);
                            env.gain.setValueAtTime(0.0001, now + i * 0.1);
                            env.gain.exponentialRampToValueAtTime(0.1, now + i * 0.1 + 0.02);
                            env.gain.exponentialRampToValueAtTime(0.0001, now + i * 0.1 + 0.3);
                            o.start(now + i * 0.1);
                            o.stop(now + i * 0.1 + 0.35);
                        });
                        break;
                    }
                    default:
                        beep(880, now, 0.15);
                }
            }

            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∑–≤—É–∫–∏
            handleSoundFileUpload(event) {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    const base64 = e.target.result;
                    const name = file.name.replace(/\.[^.]+$/, ''); // –£–±–∏—Ä–∞–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                    const customSounds = JSON.parse(localStorage.getItem('customSounds') || '[]');
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–π –∑–≤—É–∫
                    const exists = customSounds.find(s => s.name === name);
                    if (exists) {
                        exists.data = base64;
                    } else {
                        customSounds.push({ name, data: base64 });
                    }
                    
                    localStorage.setItem('customSounds', JSON.stringify(customSounds));
                    this.loadCustomSounds();
                };
                
                reader.readAsDataURL(file);
                event.target.value = ''; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º input
            }

            loadCustomSounds() {
                const customSounds = JSON.parse(localStorage.getItem('customSounds') || '[]');
                const listEl = document.getElementById('customSoundList');
                
                // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫
                listEl.innerHTML = '';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–∫–∏ –≤ select'–∞—Ö
                ['Start', 'End', 'Minute'].forEach(type => {
                    const group = document.getElementById(`customSoundsGroup${type}`);
                    group.innerHTML = '';
                    customSounds.forEach(sound => {
                        const opt = document.createElement('option');
                        opt.value = `custom:${sound.name}`;
                        opt.textContent = sound.name;
                        group.appendChild(opt);
                    });
                });

                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –∑–≤—É–∫–æ–≤
                if (customSounds.length === 0) {
                    listEl.innerHTML = '<div style="color: #999; font-size: 0.85em; padding: 8px; text-align: center;">–ù–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –∑–≤—É–∫–æ–≤</div>';
                    return;
                }

                customSounds.forEach(sound => {
                    const item = document.createElement('div');
                    item.className = 'custom-sound-item';
                    item.innerHTML = `
                        <span class="name">üéµ ${sound.name}</span>
                        <button class="btn play-btn" data-name="${sound.name}" title="–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏">‚ñ∂</button>
                        <button class="btn delete-btn" data-name="${sound.name}" title="–£–¥–∞–ª–∏—Ç—å">‚úï</button>
                    `;
                    listEl.appendChild(item);
                });

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
                listEl.querySelectorAll('.play-btn').forEach(btn => {
                    btn.addEventListener('click', () => this.playCustomSound(btn.dataset.name));
                });

                listEl.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', () => this.deleteCustomSound(btn.dataset.name));
                });
            }

            async playCustomSound(name) {
                const customSounds = JSON.parse(localStorage.getItem('customSounds') || '[]');
                const sound = customSounds.find(s => s.name === name);
                if (!sound) {
                    console.warn('Custom sound not found:', name);
                    // –ü—Ä–æ–∏–≥—Ä–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π beep –µ—Å–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–π –∑–≤—É–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω
                    await this.beep(880, 0.15);
                    return;
                }

                const audio = new Audio(sound.data);
                audio.volume = 0.5;
                try {
                    await audio.play();
                } catch (err) {
                    console.error('Error playing custom sound:', err);
                    // –ü—Ä–æ–∏–≥—Ä–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π beep –µ—Å–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–π –∑–≤—É–∫ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª
                    await this.beep(880, 0.15);
                }
            }

            deleteCustomSound(name) {
                const customSounds = JSON.parse(localStorage.getItem('customSounds') || '[]');
                const filtered = customSounds.filter(s => s.name !== name);
                localStorage.setItem('customSounds', JSON.stringify(filtered));
                this.loadCustomSounds();
            }

            async beep(freq, dur) {
                const ctx = new (window.AudioContext || window.webkitAudioContext)();
                // –í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º AudioContext –µ—Å–ª–∏ –æ–Ω –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
                if (ctx.state === 'suspended') {
                    await ctx.resume();
                }
                const o = ctx.createOscillator();
                const g = ctx.createGain();
                o.connect(g);
                g.connect(ctx.destination);
                o.frequency.value = freq;
                g.gain.setValueAtTime(0.2, ctx.currentTime);
                g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + dur);
                o.start();
                o.stop(ctx.currentTime + dur);
            }

            capitalize(str) {
                return str.charAt(0).toUpperCase() + str.slice(1);
            }
        }

        // CSS –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –æ—à–∏–±–∫–∏
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(-10px); }
                75% { transform: translateX(10px); }
            }
        `;
        document.head.appendChild(style);

        new TimerController();

        // FAQ Modal Logic
        const faqBtn = document.getElementById('faqBtn');
        const faqModal = document.getElementById('faqModal');
        const faqClose = document.getElementById('faqClose');
        const faqQuestions = document.querySelectorAll('.faq-question');

        // Open FAQ modal
        faqBtn.addEventListener('click', () => {
            faqModal.classList.add('show');
        });

        // Close FAQ modal
        faqClose.addEventListener('click', () => {
            faqModal.classList.remove('show');
        });

        // Close on backdrop click
        faqModal.addEventListener('click', (e) => {
            if (e.target === faqModal) {
                faqModal.classList.remove('show');
            }
        });

        // Close on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && faqModal.classList.contains('show')) {
                faqModal.classList.remove('show');
            }
        });

        // Toggle FAQ items (accordion)
        faqQuestions.forEach(question => {
            question.addEventListener('click', () => {
                const item = question.parentElement;
                const wasOpen = item.classList.contains('open');

                // Close all items in the same section
                const section = item.closest('.faq-section');
                section.querySelectorAll('.faq-item').forEach(i => i.classList.remove('open'));

                // Toggle clicked item
                if (!wasOpen) {
                    item.classList.add('open');
                }
            });
        });

        // FIX BUG-027: Keyboard shortcuts
        document.addEventListener('keydown', (event) => {
            // Ignore if user is typing in an input field
            if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') {
                return;
            }

            // Space: Start/Pause timer
            if (event.code === 'Space') {
                event.preventDefault();
                if (window.timerController && window.timerController.state) {
                    if (window.timerController.state.isRunning) {
                        window.timerController.pauseTimer();
                    } else {
                        window.timerController.startTimer();
                    }
                }
            }

            // R: Reset timer
            else if (event.code === 'KeyR' && !event.ctrlKey && !event.metaKey) {
                event.preventDefault();
                if (window.timerController) {
                    window.timerController.resetTimer();
                }
            }

            // S: Stop timer
            else if (event.code === 'KeyS' && !event.ctrlKey && !event.metaKey) {
                event.preventDefault();
                if (window.timerController) {
                    window.timerController.stopTimer();
                }
            }

            // W: Open widget
            else if (event.code === 'KeyW' && !event.ctrlKey && !event.metaKey) {
                event.preventDefault();
                ipcRenderer.send('open-widget');
            }

            // D: Open display (fullscreen)
            else if (event.code === 'KeyD' && !event.ctrlKey && !event.metaKey) {
                event.preventDefault();
                if (window.timerController) {
                    window.timerController.openDisplayWindow();
                }
            }

            // 1-5: Quick timer presets
            else if (event.code >= 'Digit1' && event.code <= 'Digit5' && !event.ctrlKey && !event.metaKey) {
                event.preventDefault();
                const presetIndex = parseInt(event.code.replace('Digit', '')) - 1;
                const presets = [60, 300, 600, 900, 1800]; // 1, 5, 10, 15, 30 minutes
                if (window.timerController) {
                    window.timerController.setTimer(presets[presetIndex]);
                }
            }

            // Escape: Close widget/display
            else if (event.code === 'Escape') {
                event.preventDefault();
                ipcRenderer.send('close-widget');
                ipcRenderer.send('close-display');
            }

            // F1: Show help/shortcuts
            else if (event.code === 'F1') {
                event.preventDefault();
                showKeyboardShortcuts();
            }
        });

        // Show keyboard shortcuts help
        function showKeyboardShortcuts() {
            const shortcuts = `
                <div style="background: white; padding: 20px; border-radius: 10px; max-width: 400px;">
                    <h3 style="margin-top: 0; color: #333;">‚å®Ô∏è –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏</h3>
                    <div style="color: #666; line-height: 1.8;">
                        <b>Space</b> - –°—Ç–∞—Ä—Ç/–ü–∞—É–∑–∞ —Ç–∞–π–º–µ—Ä–∞<br>
                        <b>R</b> - –°–±—Ä–æ—Å —Ç–∞–π–º–µ—Ä–∞<br>
                        <b>S</b> - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∞–π–º–µ—Ä<br>
                        <b>W</b> - –û—Ç–∫—Ä—ã—Ç—å –≤–∏–¥–∂–µ—Ç<br>
                        <b>D</b> - –û—Ç–∫—Ä—ã—Ç—å –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π –¥–∏—Å–ø–ª–µ–π<br>
                        <b>1-5</b> - –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–µ—Å–µ—Ç—ã (1, 5, 10, 15, 30 –º–∏–Ω)<br>
                        <b>Esc</b> - –ó–∞–∫—Ä—ã—Ç—å –≤–∏–¥–∂–µ—Ç/–¥–∏—Å–ø–ª–µ–π<br>
                        <b>F1</b> - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É<br>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()"
                            style="margin-top: 15px; padding: 8px 20px; background: #4CAF50;
                                   color: white; border: none; border-radius: 5px; cursor: pointer;">
                        –ó–∞–∫—Ä—ã—Ç—å
                    </button>
                </div>
            `;

            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed; top: 0; left: 0; right: 0; bottom: 0;
                background: rgba(0,0,0,0.7); display: flex; align-items: center;
                justify-content: center; z-index: 10000;
            `;
            overlay.innerHTML = shortcuts;
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) overlay.remove();
            });
            document.body.appendChild(overlay);
        }

        // Log keyboard shortcuts on startup (can be removed later)
        console.log('‚å®Ô∏è Keyboard shortcuts enabled. Press F1 for help.');
    </script>
</body>
</html>